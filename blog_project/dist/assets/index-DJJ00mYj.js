var e=Object.defineProperty,t=Object.defineProperties,r=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,l=(t,r,a)=>r in t?e(t,r,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[r]=a,n=(e,t)=>{for(var r in t||(t={}))o.call(t,r)&&l(e,r,t[r]);if(a)for(var r of a(t))s.call(t,r)&&l(e,r,t[r]);return e},i=(e,a)=>t(e,r(a)),c=(e,t)=>{var r={};for(var l in e)o.call(e,l)&&t.indexOf(l)<0&&(r[l]=e[l]);if(null!=e&&a)for(var l of a(e))t.indexOf(l)<0&&s.call(e,l)&&(r[l]=e[l]);return r},d=(e,t,r)=>new Promise((a,o)=>{var s=e=>{try{n(r.next(e))}catch(t){o(t)}},l=e=>{try{n(r.throw(e))}catch(t){o(t)}},n=e=>e.done?a(e.value):Promise.resolve(e.value).then(s,l);n((r=r.apply(e,t)).next())});import{R as g,j as u,r as h,u as m,b as p,c as x,V as b,d as y,v as k,t as f,e as v,E as w}from"./editor-DJyeaa9C.js";import{a as j}from"./vendor-DtuzQOD1.js";import{h as N}from"./syntax-Bv-h_uCC.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const r of e)if("childList"===r.type)for(const e of r.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var S,C={};var T=function(){if(S)return C;S=1;var e=j();return C.createRoot=e.createRoot,C.hydrateRoot=e.hydrateRoot,C}();class z extends g.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}render(){return this.state.hasError?u.jsxs("div",{className:"p-4 border border-red-500 rounded",children:[u.jsx("h2",{className:"text-red-500",children:"Something went wrong."}),u.jsx("pre",{className:"mt-2 text-sm",children:(e=this.state.error,e instanceof Error?e.message+"\n"+e.stack:JSON.stringify(e,null,2))})]}):this.props.children;var e}}function E(e){return d(this,null,function*(){const t=(new TextEncoder).encode(e+"blog-salt-2025"),r=yield crypto.subtle.digest("SHA-256",t);return Array.from(new Uint8Array(r)).map(e=>e.toString(16).padStart(2,"0")).join("")})}const M={articles:[],comments:[],users:[],currentUser:null,isAuthenticated:!1,isAdminMode:!1,siteSettings:{siteName:"xdazzl 的个人博客",siteDescription:"分享技术，记录生活",siteAuthor:"xdazzl",backgroundImages:["/images/anime_bg_1.jpeg","/images/anime_bg_2.jpg","/images/anime_bg_3.jpg"],customBackgrounds:[],currentBackground:"/images/anime_bg_1.jpeg",theme:"auto",socialLinks:{github:"https://github.com/xdazzl",twitter:"https://twitter.com/xdazzl",weibo:"https://weibo.com/xdazzl",email:"xdazzl@example.com",bilibili:"",wechat:"",qq:""},socialLinksEnabled:{github:!0,twitter:!0,weibo:!0,email:!0,bilibili:!1,wechat:!1,qq:!1},articlesPerPage:6,musicSettings:{isEnabled:!1,autoPlay:!1,autoPlayConditions:[],playMode:"sequence",volume:.7},enableComments:!0,requireLoginForComments:!0},currentTheme:"light",musicTracks:[],currentTrack:null,isPlaying:!1,gitHubConfig:null,lastSyncTime:null};function A(e,t){var r,a;switch(t.type){case"SET_ARTICLES":return i(n({},e),{articles:t.payload});case"ADD_ARTICLE":const o=[t.payload,...e.articles];return i(n({},e),{articles:o});case"UPDATE_ARTICLE":return i(n({},e),{articles:e.articles.map(e=>e.id===t.payload.id?t.payload:e)});case"DELETE_ARTICLE":return i(n({},e),{articles:e.articles.filter(e=>e.id!==t.payload)});case"ADD_COMMENT":return i(n({},e),{comments:[...e.comments,t.payload]});case"SET_COMMENTS":return i(n({},e),{comments:t.payload});case"LOGIN":return i(n({},e),{currentUser:t.payload,isAuthenticated:!0,isAdminMode:"admin"===t.payload.role});case"LOGOUT":return i(n({},e),{currentUser:null,isAuthenticated:!1,isAdminMode:!1});case"REGISTER_USER":return i(n({},e),{users:[...e.users,t.payload]});case"SET_USERS":return i(n({},e),{users:t.payload});case"UPDATE_USER":return i(n({},e),{users:e.users.map(e=>e.id===t.payload.id?t.payload:e),currentUser:(null==(r=e.currentUser)?void 0:r.id)===t.payload.id?t.payload:e.currentUser});case"DELETE_USER":return i(n({},e),{users:e.users.filter(e=>e.id!==t.payload)});case"SET_ADMIN_MODE":return i(n({},e),{isAdminMode:t.payload});case"DELETE_COMMENT":return i(n({},e),{comments:e.comments.filter(e=>e.id!==t.payload)});case"UPDATE_SITE_SETTINGS":return i(n({},e),{siteSettings:n(n({},e.siteSettings),t.payload)});case"SET_THEME":return i(n({},e),{currentTheme:t.payload});case"TOGGLE_THEME":return i(n({},e),{currentTheme:"light"===e.currentTheme?"dark":"light"});case"SET_MUSIC_TRACKS":return i(n({},e),{musicTracks:t.payload});case"ADD_MUSIC_TRACK":return i(n({},e),{musicTracks:[...e.musicTracks,t.payload]});case"DELETE_MUSIC_TRACK":return i(n({},e),{musicTracks:e.musicTracks.filter(e=>e.id!==t.payload),currentTrack:(null==(a=e.currentTrack)?void 0:a.id)===t.payload?null:e.currentTrack});case"SET_CURRENT_TRACK":return i(n({},e),{currentTrack:t.payload});case"SET_PLAYING":return i(n({},e),{isPlaying:t.payload});case"SET_GITHUB_CONFIG":return i(n({},e),{gitHubConfig:t.payload});case"SET_LAST_SYNC_TIME":return i(n({},e),{lastSyncTime:t.payload});case"LOAD_DATA":return n(n({},e),t.payload);default:return e}}const L=h.createContext({state:M,dispatch:()=>null});function R({children:e}){const[t,r]=h.useReducer(A,M);return h.useEffect(()=>{(()=>{d(this,null,function*(){try{const e=localStorage.getItem("blog-data");if(e){const t=JSON.parse(e);if(t.users){const e=yield Promise.all(t.users.map(e=>d(this,null,function*(){if(64!==e.password.length){const t=yield E(e.password);return i(n({},e),{password:t})}return e})));t.users=e}r({type:"LOAD_DATA",payload:t})}else{const e=yield E("czl737476534?!"),t=[{id:"1",title:"欢迎来到我的博客",content:"# 欢迎来到我的个人博客\n\n这是我的第一篇博客文章。在这里，我将分享我的技术学习心得、生活感悟和一些有趣的发现。\n\n## 关于这个博客\n\n这个博客使用现代前端技术构建，具有以下特色：\n\n- 🎨 **美观的界面设计** - 采用二次元风格背景，支持亮色/暗色主题切换\n- 📝 **富文本编辑器** - 支持 Markdown 语法，代码高亮\n- 💬 **评论系统** - 可以与访客互动交流\n- 📱 **响应式设计** - 完美适配移动端和桌面端\n- ⚡ **性能优化** - 图片懒加载，流畅的动画效果\n- 🎵 **音乐播放** - 支持背景音乐播放\n\n## 技术栈\n\n- React 18 + TypeScript\n- Tailwind CSS\n- Markdown 编辑器\n- GitHub 数据同步\n\n欢迎大家在评论区与我交流！",summary:"欢迎来到我的个人博客！这里将分享技术心得和生活感悟。",tags:["欢迎","博客","介绍"],createdAt:"2025-06-28T08:57:13.000Z",updatedAt:"2025-06-28T08:57:13.000Z",views:0,likes:0,published:!0,coverImage:"/images/anime_bg_1.jpeg"}],a=[{id:"1",articleId:"1",author:"访客",email:"visitor@example.com",content:"欢迎开通博客！界面很漂亮呢～",createdAt:"2025-06-28T09:00:00.000Z"}];r({type:"SET_USERS",payload:[{id:"admin-1",username:"xdazzl",password:e,displayName:"xdazzl",email:"xdazzl@example.com",bio:"一个热爱技术的博主",role:"admin",createdAt:"2025-06-28T08:00:00.000Z",isActive:!0}]}),r({type:"SET_ARTICLES",payload:t}),r({type:"SET_COMMENTS",payload:a})}}catch(e){console.error("Failed to load data:",e)}})})()},[]),h.useEffect(()=>{(()=>{try{const e={articles:t.articles,comments:t.comments,users:t.users,siteSettings:t.siteSettings,musicTracks:t.musicTracks,gitHubConfig:t.gitHubConfig,lastSyncTime:t.lastSyncTime};localStorage.setItem("blog-data",JSON.stringify(e))}catch(e){console.error("Failed to save data:",e)}})()},[t.articles,t.comments,t.users,t.siteSettings,t.musicTracks,t.gitHubConfig,t.lastSyncTime]),h.useEffect(()=>{const e=()=>{if("auto"===t.siteSettings.theme){const e=window.matchMedia("(prefers-color-scheme: dark)").matches;r({type:"SET_THEME",payload:e?"dark":"light"})}else r({type:"SET_THEME",payload:t.siteSettings.theme})};e();const a=window.matchMedia("(prefers-color-scheme: dark)");return a.addEventListener("change",e),()=>a.removeEventListener("change",e)},[t.siteSettings.theme]),u.jsx(L.Provider,{value:{state:t,dispatch:r},children:e})}const O=()=>{const e=h.useContext(L);if(!e)throw new Error("useBlog must be used within a BlogProvider");return e};
/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var P={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};
/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $=(e,t)=>{const r=h.forwardRef((r,a)=>{var o,s=r,{color:l="currentColor",size:d=24,strokeWidth:g=2,absoluteStrokeWidth:u,className:m="",children:p}=s,x=c(s,["color","size","strokeWidth","absoluteStrokeWidth","className","children"]);return h.createElement("svg",n(i(n({ref:a},P),{width:d,height:d,stroke:l,strokeWidth:u?24*Number(g)/Number(d):g,className:["lucide",`lucide-${o=e,o.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,m].join(" ")}),x),[...t.map(([e,t])=>h.createElement(e,t)),...Array.isArray(p)?p:[p]])});return r.displayName=`${e}`,r},_=$("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),I=$("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]),D=$("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),q=$("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),H=$("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),U=$("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),G=$("CloudUpload",[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M12 12v9",key:"192myk"}],["path",{d:"m16 16-4-4-4 4",key:"119tzi"}]]),F=$("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),B=$("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),V=$("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]),K=$("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),W=$("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]),Z=$("Github",[["path",{d:"M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4",key:"tonef"}],["path",{d:"M9 18c-4.51 2-5-2-7-2",key:"9comsn"}]]),Y=$("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]),J=$("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]),Q=$("Key",[["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["path",{d:"m15.5 7.5 3 3L22 7l-3-3",key:"1rn1fs"}]]),X=$("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),ee=$("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]),te=$("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),re=$("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),ae=$("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]),oe=$("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]),se=$("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]),le=$("Music",[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]]),ne=$("Pause",[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]]),ie=$("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]),ce=$("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),de=$("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),ge=$("Repeat1",[["path",{d:"m17 2 4 4-4 4",key:"nntrym"}],["path",{d:"M3 11v-1a4 4 0 0 1 4-4h14",key:"84bu3i"}],["path",{d:"m7 22-4-4 4-4",key:"1wqhfi"}],["path",{d:"M21 13v1a4 4 0 0 1-4 4H3",key:"1rx37r"}],["path",{d:"M11 10h1v4",key:"70cz1p"}]]),ue=$("Repeat",[["path",{d:"m17 2 4 4-4 4",key:"nntrym"}],["path",{d:"M3 11v-1a4 4 0 0 1 4-4h14",key:"84bu3i"}],["path",{d:"m7 22-4-4 4-4",key:"1wqhfi"}],["path",{d:"M21 13v1a4 4 0 0 1-4 4H3",key:"1rx37r"}]]),he=$("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),me=$("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]),pe=$("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),xe=$("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]),be=$("Shuffle",[["path",{d:"M2 18h1.4c1.3 0 2.5-.6 3.3-1.7l6.1-8.6c.7-1.1 2-1.7 3.3-1.7H22",key:"1wmou1"}],["path",{d:"m18 2 4 4-4 4",key:"pucp1d"}],["path",{d:"M2 6h1.9c1.5 0 2.9.9 3.6 2.2",key:"10bdb2"}],["path",{d:"M22 18h-5.9c-1.3 0-2.6-.7-3.3-1.8l-.5-.8",key:"vgxac0"}],["path",{d:"m18 14 4 4-4 4",key:"10pe0f"}]]),ye=$("SkipBack",[["polygon",{points:"19 20 9 12 19 4 19 20",key:"o2sva"}],["line",{x1:"5",x2:"5",y1:"19",y2:"5",key:"1ocqjk"}]]),ke=$("SkipForward",[["polygon",{points:"5 4 15 12 5 20 5 4",key:"16p6eg"}],["line",{x1:"19",x2:"19",y1:"5",y2:"19",key:"futhcm"}]]),fe=$("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]),ve=$("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]),we=$("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]),je=$("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),Ne=$("Twitter",[["path",{d:"M22 4s-.7 2.1-2 3.4c1.6 10-9.4 17.3-18 11.6 2.2.1 4.4-.6 6-2C3 15.5.5 9.6 3 5c2.2 2.6 5.6 4.1 9 4-.9-4.2 4-6.6 7-3.8 1.1 0 3-1.2 3-1.2z",key:"pff0z6"}]]),Se=$("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),Ce=$("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]),Te=$("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),ze=$("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]),Ee=$("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),Me=$("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),Ae=$("Volume2",[["polygon",{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5",key:"16drj5"}],["path",{d:"M15.54 8.46a5 5 0 0 1 0 7.07",key:"ltjumu"}],["path",{d:"M19.07 4.93a10 10 0 0 1 0 14.14",key:"1kegas"}]]),Le=$("VolumeX",[["polygon",{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5",key:"16drj5"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]]),Re=$("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);
/**
 * @license lucide-react v0.364.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */function Oe(){const{state:e,dispatch:t}=O(),{siteSettings:r,currentTheme:a}=e,o={github:Z,twitter:Ne,weibo:oe,email:re};return u.jsx("header",{className:"sticky top-0 z-50 backdrop-blur-md border-b transition-colors duration-300 "+("dark"===a?"bg-gray-900/80 border-gray-700":"bg-white/80 border-gray-200"),children:u.jsx("div",{className:"max-w-6xl mx-auto px-4 py-4",children:u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsx("h1",{className:"text-2xl font-bold transition-colors "+("dark"===a?"text-white":"text-gray-800"),children:r.siteName}),u.jsx("p",{className:"hidden md:block text-sm transition-colors "+("dark"===a?"text-gray-300":"text-gray-600"),children:r.siteDescription})]}),u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsx("div",{className:"flex items-center space-x-3",children:Object.entries(r.socialLinks).map(([e,t])=>{if(!t)return null;const r=o[e];return r?u.jsx("a",{href:t,target:"_blank",rel:"noopener noreferrer",className:"p-2 rounded-full transition-all duration-300 hover:scale-110 "+("dark"===a?"text-gray-300 hover:text-white hover:bg-gray-700":"text-gray-600 hover:text-gray-800 hover:bg-gray-100"),title:e,children:u.jsx(r,{size:20})},e):null})}),u.jsx("button",{onClick:()=>{t({type:"TOGGLE_THEME"});t({type:"UPDATE_SITE_SETTINGS",payload:{theme:"light"===a?"dark":"light"}})},className:"p-2 rounded-full transition-all duration-300 hover:scale-110 "+("dark"===a?"text-yellow-400 hover:bg-gray-700":"text-gray-600 hover:bg-gray-100"),title:"切换主题",children:"dark"===a?u.jsx(ve,{size:20}):u.jsx(se,{size:20})})]})]})})})}function Pe({onSelectArticle:e}){const{state:t}=O(),{articles:r,siteSettings:a,currentTheme:o}=t,[s,l]=h.useState(1),[n,i]=h.useState(null),c=r.filter(e=>e.published),d=n?c.filter(e=>e.tags.includes(n)):c,g=a.articlesPerPage,m=Math.ceil(d.length/g),p=(s-1)*g,x=d.slice(p,p+g),b=h.useMemo(()=>{const e=new Set;return c.forEach(t=>{t.tags.forEach(t=>e.add(t))}),Array.from(e)},[c]),y=e=>{i(n===e?null:e),l(1)};return u.jsx("div",{className:"min-h-screen transition-colors duration-300 "+("dark"===o?"text-white":"text-gray-800"),children:u.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-8",children:[b.length>0&&u.jsxs("div",{className:"mb-8",children:[u.jsx("h3",{className:"text-lg font-semibold mb-4 "+("dark"===o?"text-gray-200":"text-gray-700"),children:"标签筛选"}),u.jsxs("div",{className:"flex flex-wrap gap-2",children:[u.jsx("button",{onClick:()=>y(""),className:"px-3 py-1 rounded-full text-sm transition-all duration-300 "+(n?"dark"===o?"bg-gray-700 text-gray-300 hover:bg-gray-600":"bg-gray-200 text-gray-700 hover:bg-gray-300":"dark"===o?"bg-blue-600 text-white":"bg-blue-500 text-white"),children:"全部"}),b.map(e=>u.jsx("button",{onClick:()=>y(e),className:"px-3 py-1 rounded-full text-sm transition-all duration-300 "+(n===e?"dark"===o?"bg-blue-600 text-white":"bg-blue-500 text-white":"dark"===o?"bg-gray-700 text-gray-300 hover:bg-gray-600":"bg-gray-200 text-gray-700 hover:bg-gray-300"),children:e},e))]})]}),0===x.length?u.jsxs("div",{className:"text-center py-16 "+("dark"===o?"text-gray-400":"text-gray-500"),children:[u.jsx("p",{className:"text-xl",children:"暂无文章"}),u.jsx("p",{className:"mt-2",children:"敬请期待更多内容～"})]}):u.jsx("div",{className:"grid gap-8 md:grid-cols-2 lg:grid-cols-3",children:x.map(t=>{return u.jsxs("article",{className:"group cursor-pointer rounded-xl overflow-hidden transition-all duration-300 hover:scale-105 hover:shadow-2xl "+("dark"===o?"bg-gray-800/50 backdrop-blur-sm border border-gray-700":"bg-white/80 backdrop-blur-sm border border-gray-200 shadow-lg"),onClick:()=>e(t),children:[t.coverImage&&u.jsxs("div",{className:"relative h-48 overflow-hidden",children:[u.jsx("img",{src:t.coverImage,alt:t.title,className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-500",loading:"lazy"}),u.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/20 to-transparent"})]}),u.jsxs("div",{className:"p-6",children:[u.jsx("h2",{className:"text-xl font-bold mb-3 line-clamp-2 group-hover:text-blue-500 transition-colors "+("dark"===o?"text-white":"text-gray-800"),children:t.title}),u.jsx("p",{className:"text-sm mb-4 line-clamp-3 "+("dark"===o?"text-gray-300":"text-gray-600"),children:t.summary}),t.tags.length>0&&u.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:t.tags.map(e=>u.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs "+("dark"===o?"bg-gray-700 text-gray-300":"bg-gray-100 text-gray-600"),children:[u.jsx(we,{size:12,className:"mr-1"}),e]},e))}),u.jsx("div",{className:"flex items-center justify-between text-xs "+("dark"===o?"text-gray-400":"text-gray-500"),children:u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsxs("span",{className:"flex items-center",children:[u.jsx(I,{size:12,className:"mr-1"}),(r=t.createdAt,new Date(r).toLocaleDateString("zh-CN",{year:"numeric",month:"long",day:"numeric"}))]}),u.jsxs("span",{className:"flex items-center",children:[u.jsx(K,{size:12,className:"mr-1"}),t.views]}),u.jsxs("span",{className:"flex items-center",children:[u.jsx(Y,{size:12,className:"mr-1"}),t.likes]})]})})]})]},t.id);var r})}),m>1&&u.jsxs("div",{className:"flex justify-center items-center space-x-4 mt-12",children:[u.jsxs("button",{onClick:()=>l(Math.max(1,s-1)),disabled:1===s,className:"flex items-center px-4 py-2 rounded-lg transition-all duration-300 "+(1===s?"dark"===o?"text-gray-600 cursor-not-allowed":"text-gray-400 cursor-not-allowed":"dark"===o?"text-gray-300 hover:bg-gray-700":"text-gray-600 hover:bg-gray-100"),children:[u.jsx(H,{size:20,className:"mr-1"}),"上一页"]}),u.jsx("div",{className:"flex space-x-2",children:Array.from({length:m},(e,t)=>t+1).map(e=>u.jsx("button",{onClick:()=>l(e),className:"px-3 py-2 rounded-lg transition-all duration-300 "+(s===e?"dark"===o?"bg-blue-600 text-white":"bg-blue-500 text-white":"dark"===o?"text-gray-300 hover:bg-gray-700":"text-gray-600 hover:bg-gray-100"),children:e},e))}),u.jsxs("button",{onClick:()=>l(Math.min(m,s+1)),disabled:s===m,className:"flex items-center px-4 py-2 rounded-lg transition-all duration-300 "+(s===m?"dark"===o?"text-gray-600 cursor-not-allowed":"text-gray-400 cursor-not-allowed":"dark"===o?"text-gray-300 hover:bg-gray-700":"text-gray-600 hover:bg-gray-100"),children:["下一页",u.jsx(U,{size:20,className:"ml-1"})]})]})]})})}const $e="https://github.com/remarkjs/react-markdown/blob/main/changelog.md",_e=[],Ie={allowDangerousHtml:!0},De=/^(https?|ircs?|mailto|xmpp)$/i,qe=[{from:"astPlugins",id:"remove-buggy-html-in-markdown-parser"},{from:"allowDangerousHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"allowNode",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowElement"},{from:"allowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowedElements"},{from:"className",id:"remove-classname"},{from:"disallowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"disallowedElements"},{from:"escapeHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"includeElementIndex",id:"#remove-includeelementindex"},{from:"includeNodeIndex",id:"change-includenodeindex-to-includeelementindex"},{from:"linkTarget",id:"remove-linktarget"},{from:"plugins",id:"change-plugins-to-remarkplugins",to:"remarkPlugins"},{from:"rawSourcePos",id:"#remove-rawsourcepos"},{from:"renderers",id:"change-renderers-to-components",to:"components"},{from:"source",id:"change-source-to-children",to:"children"},{from:"sourcePos",id:"#remove-sourcepos"},{from:"transformImageUri",id:"#add-urltransform",to:"urlTransform"},{from:"transformLinkUri",id:"#add-urltransform",to:"urlTransform"}];function He(e){const t=function(e){const t=e.rehypePlugins||_e,r=e.remarkPlugins||_e,a=e.remarkRehypeOptions?n(n({},e.remarkRehypeOptions),Ie):Ie,o=m().use(p).use(r).use(x,a).use(t);return o}(e),r=function(e){const t=e.children||"",r=new b;"string"==typeof t&&(r.value=t);return r}(e);return function(e,t){const r=t.allowedElements,a=t.allowElement,o=t.components,s=t.disallowedElements,l=t.skipHtml,n=t.unwrapDisallowed,i=t.urlTransform||Ue;for(const d of qe)Object.hasOwn(t,d.from)&&y("Unexpected `"+d.from+"` prop, "+(d.to?"use `"+d.to+"` instead":"remove it")+" (see <"+$e+"#"+d.id+"> for more info)");return k(e,c),f(e,{Fragment:u.Fragment,components:o,ignoreInvalidStyle:!0,jsx:u.jsx,jsxs:u.jsxs,passKeys:!0,passNode:!0});function c(e,t,o){if("raw"===e.type&&o&&"number"==typeof t)return l?o.children.splice(t,1):o.children[t]={type:"text",value:e.value},t;if("element"===e.type){let t;for(t in v)if(Object.hasOwn(v,t)&&Object.hasOwn(e.properties,t)){const r=e.properties[t],a=v[t];(null===a||a.includes(e.tagName))&&(e.properties[t]=i(String(r||""),t,e))}}if("element"===e.type){let l=r?!r.includes(e.tagName):!!s&&s.includes(e.tagName);if(!l&&a&&"number"==typeof t&&(l=!a(e,t,o)),l&&o&&"number"==typeof t)return n&&e.children?o.children.splice(t,1,...e.children):o.children.splice(t,1),t}}}(t.runSync(t.parse(r),r),e)}function Ue(e){const t=e.indexOf(":"),r=e.indexOf("?"),a=e.indexOf("#"),o=e.indexOf("/");return-1===t||-1!==o&&t>o||-1!==r&&t>r||-1!==a&&t>a||De.test(e.slice(0,t))?e:""}const Ge={'code[class*="language-"]':{background:"hsl(220, 13%, 18%)",color:"hsl(220, 14%, 71%)",textShadow:"0 1px rgba(0, 0, 0, 0.3)",fontFamily:'"Fira Code", "Fira Mono", Menlo, Consolas, "DejaVu Sans Mono", monospace',direction:"ltr",textAlign:"left",whiteSpace:"pre",wordSpacing:"normal",wordBreak:"normal",lineHeight:"1.5",MozTabSize:"2",OTabSize:"2",tabSize:"2",WebkitHyphens:"none",MozHyphens:"none",msHyphens:"none",hyphens:"none"},'pre[class*="language-"]':{background:"hsl(220, 13%, 18%)",color:"hsl(220, 14%, 71%)",textShadow:"0 1px rgba(0, 0, 0, 0.3)",fontFamily:'"Fira Code", "Fira Mono", Menlo, Consolas, "DejaVu Sans Mono", monospace',direction:"ltr",textAlign:"left",whiteSpace:"pre",wordSpacing:"normal",wordBreak:"normal",lineHeight:"1.5",MozTabSize:"2",OTabSize:"2",tabSize:"2",WebkitHyphens:"none",MozHyphens:"none",msHyphens:"none",hyphens:"none",padding:"1em",margin:"0.5em 0",overflow:"auto",borderRadius:"0.3em"},'code[class*="language-"]::-moz-selection':{background:"hsl(220, 13%, 28%)",color:"inherit",textShadow:"none"},'code[class*="language-"] *::-moz-selection':{background:"hsl(220, 13%, 28%)",color:"inherit",textShadow:"none"},'pre[class*="language-"] *::-moz-selection':{background:"hsl(220, 13%, 28%)",color:"inherit",textShadow:"none"},'code[class*="language-"]::selection':{background:"hsl(220, 13%, 28%)",color:"inherit",textShadow:"none"},'code[class*="language-"] *::selection':{background:"hsl(220, 13%, 28%)",color:"inherit",textShadow:"none"},'pre[class*="language-"] *::selection':{background:"hsl(220, 13%, 28%)",color:"inherit",textShadow:"none"},':not(pre) > code[class*="language-"]':{padding:"0.2em 0.3em",borderRadius:"0.3em",whiteSpace:"normal"},comment:{color:"hsl(220, 10%, 40%)",fontStyle:"italic"},prolog:{color:"hsl(220, 10%, 40%)"},cdata:{color:"hsl(220, 10%, 40%)"},doctype:{color:"hsl(220, 14%, 71%)"},punctuation:{color:"hsl(220, 14%, 71%)"},entity:{color:"hsl(220, 14%, 71%)",cursor:"help"},"attr-name":{color:"hsl(29, 54%, 61%)"},"class-name":{color:"hsl(29, 54%, 61%)"},boolean:{color:"hsl(29, 54%, 61%)"},constant:{color:"hsl(29, 54%, 61%)"},number:{color:"hsl(29, 54%, 61%)"},atrule:{color:"hsl(29, 54%, 61%)"},keyword:{color:"hsl(286, 60%, 67%)"},property:{color:"hsl(355, 65%, 65%)"},tag:{color:"hsl(355, 65%, 65%)"},symbol:{color:"hsl(355, 65%, 65%)"},deleted:{color:"hsl(355, 65%, 65%)"},important:{color:"hsl(355, 65%, 65%)"},selector:{color:"hsl(95, 38%, 62%)"},string:{color:"hsl(95, 38%, 62%)"},char:{color:"hsl(95, 38%, 62%)"},builtin:{color:"hsl(95, 38%, 62%)"},inserted:{color:"hsl(95, 38%, 62%)"},regex:{color:"hsl(95, 38%, 62%)"},"attr-value":{color:"hsl(95, 38%, 62%)"},"attr-value > .token.punctuation":{color:"hsl(95, 38%, 62%)"},variable:{color:"hsl(207, 82%, 66%)"},operator:{color:"hsl(207, 82%, 66%)"},function:{color:"hsl(207, 82%, 66%)"},url:{color:"hsl(187, 47%, 55%)"},"attr-value > .token.punctuation.attr-equals":{color:"hsl(220, 14%, 71%)"},"special-attr > .token.attr-value > .token.value.css":{color:"hsl(220, 14%, 71%)"},".language-css .token.selector":{color:"hsl(355, 65%, 65%)"},".language-css .token.property":{color:"hsl(220, 14%, 71%)"},".language-css .token.function":{color:"hsl(187, 47%, 55%)"},".language-css .token.url > .token.function":{color:"hsl(187, 47%, 55%)"},".language-css .token.url > .token.string.url":{color:"hsl(95, 38%, 62%)"},".language-css .token.important":{color:"hsl(286, 60%, 67%)"},".language-css .token.atrule .token.rule":{color:"hsl(286, 60%, 67%)"},".language-javascript .token.operator":{color:"hsl(286, 60%, 67%)"},".language-javascript .token.template-string > .token.interpolation > .token.interpolation-punctuation.punctuation":{color:"hsl(5, 48%, 51%)"},".language-json .token.operator":{color:"hsl(220, 14%, 71%)"},".language-json .token.null.keyword":{color:"hsl(29, 54%, 61%)"},".language-markdown .token.url":{color:"hsl(220, 14%, 71%)"},".language-markdown .token.url > .token.operator":{color:"hsl(220, 14%, 71%)"},".language-markdown .token.url-reference.url > .token.string":{color:"hsl(220, 14%, 71%)"},".language-markdown .token.url > .token.content":{color:"hsl(207, 82%, 66%)"},".language-markdown .token.url > .token.url":{color:"hsl(187, 47%, 55%)"},".language-markdown .token.url-reference.url":{color:"hsl(187, 47%, 55%)"},".language-markdown .token.blockquote.punctuation":{color:"hsl(220, 10%, 40%)",fontStyle:"italic"},".language-markdown .token.hr.punctuation":{color:"hsl(220, 10%, 40%)",fontStyle:"italic"},".language-markdown .token.code-snippet":{color:"hsl(95, 38%, 62%)"},".language-markdown .token.bold .token.content":{color:"hsl(29, 54%, 61%)"},".language-markdown .token.italic .token.content":{color:"hsl(286, 60%, 67%)"},".language-markdown .token.strike .token.content":{color:"hsl(355, 65%, 65%)"},".language-markdown .token.strike .token.punctuation":{color:"hsl(355, 65%, 65%)"},".language-markdown .token.list.punctuation":{color:"hsl(355, 65%, 65%)"},".language-markdown .token.title.important > .token.punctuation":{color:"hsl(355, 65%, 65%)"},bold:{fontWeight:"bold"},italic:{fontStyle:"italic"},namespace:{Opacity:"0.8"},"token.tab:not(:empty):before":{color:"hsla(220, 14%, 71%, 0.15)",textShadow:"none"},"token.cr:before":{color:"hsla(220, 14%, 71%, 0.15)",textShadow:"none"},"token.lf:before":{color:"hsla(220, 14%, 71%, 0.15)",textShadow:"none"},"token.space:before":{color:"hsla(220, 14%, 71%, 0.15)",textShadow:"none"},"div.code-toolbar > .toolbar.toolbar > .toolbar-item":{marginRight:"0.4em"},"div.code-toolbar > .toolbar.toolbar > .toolbar-item > button":{background:"hsl(220, 13%, 26%)",color:"hsl(220, 9%, 55%)",padding:"0.1em 0.4em",borderRadius:"0.3em"},"div.code-toolbar > .toolbar.toolbar > .toolbar-item > a":{background:"hsl(220, 13%, 26%)",color:"hsl(220, 9%, 55%)",padding:"0.1em 0.4em",borderRadius:"0.3em"},"div.code-toolbar > .toolbar.toolbar > .toolbar-item > span":{background:"hsl(220, 13%, 26%)",color:"hsl(220, 9%, 55%)",padding:"0.1em 0.4em",borderRadius:"0.3em"},"div.code-toolbar > .toolbar.toolbar > .toolbar-item > button:hover":{background:"hsl(220, 13%, 28%)",color:"hsl(220, 14%, 71%)"},"div.code-toolbar > .toolbar.toolbar > .toolbar-item > button:focus":{background:"hsl(220, 13%, 28%)",color:"hsl(220, 14%, 71%)"},"div.code-toolbar > .toolbar.toolbar > .toolbar-item > a:hover":{background:"hsl(220, 13%, 28%)",color:"hsl(220, 14%, 71%)"},"div.code-toolbar > .toolbar.toolbar > .toolbar-item > a:focus":{background:"hsl(220, 13%, 28%)",color:"hsl(220, 14%, 71%)"},"div.code-toolbar > .toolbar.toolbar > .toolbar-item > span:hover":{background:"hsl(220, 13%, 28%)",color:"hsl(220, 14%, 71%)"},"div.code-toolbar > .toolbar.toolbar > .toolbar-item > span:focus":{background:"hsl(220, 13%, 28%)",color:"hsl(220, 14%, 71%)"},".line-highlight.line-highlight":{background:"hsla(220, 100%, 80%, 0.04)"},".line-highlight.line-highlight:before":{background:"hsl(220, 13%, 26%)",color:"hsl(220, 14%, 71%)",padding:"0.1em 0.6em",borderRadius:"0.3em",boxShadow:"0 2px 0 0 rgba(0, 0, 0, 0.2)"},".line-highlight.line-highlight[data-end]:after":{background:"hsl(220, 13%, 26%)",color:"hsl(220, 14%, 71%)",padding:"0.1em 0.6em",borderRadius:"0.3em",boxShadow:"0 2px 0 0 rgba(0, 0, 0, 0.2)"},"pre[id].linkable-line-numbers.linkable-line-numbers span.line-numbers-rows > span:hover:before":{backgroundColor:"hsla(220, 100%, 80%, 0.04)"},".line-numbers.line-numbers .line-numbers-rows":{borderRightColor:"hsla(220, 14%, 71%, 0.15)"},".command-line .command-line-prompt":{borderRightColor:"hsla(220, 14%, 71%, 0.15)"},".line-numbers .line-numbers-rows > span:before":{color:"hsl(220, 14%, 45%)"},".command-line .command-line-prompt > span:before":{color:"hsl(220, 14%, 45%)"},".rainbow-braces .token.token.punctuation.brace-level-1":{color:"hsl(355, 65%, 65%)"},".rainbow-braces .token.token.punctuation.brace-level-5":{color:"hsl(355, 65%, 65%)"},".rainbow-braces .token.token.punctuation.brace-level-9":{color:"hsl(355, 65%, 65%)"},".rainbow-braces .token.token.punctuation.brace-level-2":{color:"hsl(95, 38%, 62%)"},".rainbow-braces .token.token.punctuation.brace-level-6":{color:"hsl(95, 38%, 62%)"},".rainbow-braces .token.token.punctuation.brace-level-10":{color:"hsl(95, 38%, 62%)"},".rainbow-braces .token.token.punctuation.brace-level-3":{color:"hsl(207, 82%, 66%)"},".rainbow-braces .token.token.punctuation.brace-level-7":{color:"hsl(207, 82%, 66%)"},".rainbow-braces .token.token.punctuation.brace-level-11":{color:"hsl(207, 82%, 66%)"},".rainbow-braces .token.token.punctuation.brace-level-4":{color:"hsl(286, 60%, 67%)"},".rainbow-braces .token.token.punctuation.brace-level-8":{color:"hsl(286, 60%, 67%)"},".rainbow-braces .token.token.punctuation.brace-level-12":{color:"hsl(286, 60%, 67%)"},"pre.diff-highlight > code .token.token.deleted:not(.prefix)":{backgroundColor:"hsla(353, 100%, 66%, 0.15)"},"pre > code.diff-highlight .token.token.deleted:not(.prefix)":{backgroundColor:"hsla(353, 100%, 66%, 0.15)"},"pre.diff-highlight > code .token.token.deleted:not(.prefix)::-moz-selection":{backgroundColor:"hsla(353, 95%, 66%, 0.25)"},"pre.diff-highlight > code .token.token.deleted:not(.prefix) *::-moz-selection":{backgroundColor:"hsla(353, 95%, 66%, 0.25)"},"pre > code.diff-highlight .token.token.deleted:not(.prefix)::-moz-selection":{backgroundColor:"hsla(353, 95%, 66%, 0.25)"},"pre > code.diff-highlight .token.token.deleted:not(.prefix) *::-moz-selection":{backgroundColor:"hsla(353, 95%, 66%, 0.25)"},"pre.diff-highlight > code .token.token.deleted:not(.prefix)::selection":{backgroundColor:"hsla(353, 95%, 66%, 0.25)"},"pre.diff-highlight > code .token.token.deleted:not(.prefix) *::selection":{backgroundColor:"hsla(353, 95%, 66%, 0.25)"},"pre > code.diff-highlight .token.token.deleted:not(.prefix)::selection":{backgroundColor:"hsla(353, 95%, 66%, 0.25)"},"pre > code.diff-highlight .token.token.deleted:not(.prefix) *::selection":{backgroundColor:"hsla(353, 95%, 66%, 0.25)"},"pre.diff-highlight > code .token.token.inserted:not(.prefix)":{backgroundColor:"hsla(137, 100%, 55%, 0.15)"},"pre > code.diff-highlight .token.token.inserted:not(.prefix)":{backgroundColor:"hsla(137, 100%, 55%, 0.15)"},"pre.diff-highlight > code .token.token.inserted:not(.prefix)::-moz-selection":{backgroundColor:"hsla(135, 73%, 55%, 0.25)"},"pre.diff-highlight > code .token.token.inserted:not(.prefix) *::-moz-selection":{backgroundColor:"hsla(135, 73%, 55%, 0.25)"},"pre > code.diff-highlight .token.token.inserted:not(.prefix)::-moz-selection":{backgroundColor:"hsla(135, 73%, 55%, 0.25)"},"pre > code.diff-highlight .token.token.inserted:not(.prefix) *::-moz-selection":{backgroundColor:"hsla(135, 73%, 55%, 0.25)"},"pre.diff-highlight > code .token.token.inserted:not(.prefix)::selection":{backgroundColor:"hsla(135, 73%, 55%, 0.25)"},"pre.diff-highlight > code .token.token.inserted:not(.prefix) *::selection":{backgroundColor:"hsla(135, 73%, 55%, 0.25)"},"pre > code.diff-highlight .token.token.inserted:not(.prefix)::selection":{backgroundColor:"hsla(135, 73%, 55%, 0.25)"},"pre > code.diff-highlight .token.token.inserted:not(.prefix) *::selection":{backgroundColor:"hsla(135, 73%, 55%, 0.25)"},".prism-previewer.prism-previewer:before":{borderColor:"hsl(224, 13%, 17%)"},".prism-previewer-gradient.prism-previewer-gradient div":{borderColor:"hsl(224, 13%, 17%)",borderRadius:"0.3em"},".prism-previewer-color.prism-previewer-color:before":{borderRadius:"0.3em"},".prism-previewer-easing.prism-previewer-easing:before":{borderRadius:"0.3em"},".prism-previewer.prism-previewer:after":{borderTopColor:"hsl(224, 13%, 17%)"},".prism-previewer-flipped.prism-previewer-flipped.after":{borderBottomColor:"hsl(224, 13%, 17%)"},".prism-previewer-angle.prism-previewer-angle:before":{background:"hsl(219, 13%, 22%)"},".prism-previewer-time.prism-previewer-time:before":{background:"hsl(219, 13%, 22%)"},".prism-previewer-easing.prism-previewer-easing":{background:"hsl(219, 13%, 22%)"},".prism-previewer-angle.prism-previewer-angle circle":{stroke:"hsl(220, 14%, 71%)",strokeOpacity:"1"},".prism-previewer-time.prism-previewer-time circle":{stroke:"hsl(220, 14%, 71%)",strokeOpacity:"1"},".prism-previewer-easing.prism-previewer-easing circle":{stroke:"hsl(220, 14%, 71%)",fill:"transparent"},".prism-previewer-easing.prism-previewer-easing path":{stroke:"hsl(220, 14%, 71%)"},".prism-previewer-easing.prism-previewer-easing line":{stroke:"hsl(220, 14%, 71%)"}},Fe={'code[class*="language-"]':{background:"hsl(230, 1%, 98%)",color:"hsl(230, 8%, 24%)",fontFamily:'"Fira Code", "Fira Mono", Menlo, Consolas, "DejaVu Sans Mono", monospace',direction:"ltr",textAlign:"left",whiteSpace:"pre",wordSpacing:"normal",wordBreak:"normal",lineHeight:"1.5",MozTabSize:"2",OTabSize:"2",tabSize:"2",WebkitHyphens:"none",MozHyphens:"none",msHyphens:"none",hyphens:"none"},'pre[class*="language-"]':{background:"hsl(230, 1%, 98%)",color:"hsl(230, 8%, 24%)",fontFamily:'"Fira Code", "Fira Mono", Menlo, Consolas, "DejaVu Sans Mono", monospace',direction:"ltr",textAlign:"left",whiteSpace:"pre",wordSpacing:"normal",wordBreak:"normal",lineHeight:"1.5",MozTabSize:"2",OTabSize:"2",tabSize:"2",WebkitHyphens:"none",MozHyphens:"none",msHyphens:"none",hyphens:"none",padding:"1em",margin:"0.5em 0",overflow:"auto",borderRadius:"0.3em"},'code[class*="language-"]::-moz-selection':{background:"hsl(230, 1%, 90%)",color:"inherit"},'code[class*="language-"] *::-moz-selection':{background:"hsl(230, 1%, 90%)",color:"inherit"},'pre[class*="language-"] *::-moz-selection':{background:"hsl(230, 1%, 90%)",color:"inherit"},'code[class*="language-"]::selection':{background:"hsl(230, 1%, 90%)",color:"inherit"},'code[class*="language-"] *::selection':{background:"hsl(230, 1%, 90%)",color:"inherit"},'pre[class*="language-"] *::selection':{background:"hsl(230, 1%, 90%)",color:"inherit"},':not(pre) > code[class*="language-"]':{padding:"0.2em 0.3em",borderRadius:"0.3em",whiteSpace:"normal"},comment:{color:"hsl(230, 4%, 64%)",fontStyle:"italic"},prolog:{color:"hsl(230, 4%, 64%)"},cdata:{color:"hsl(230, 4%, 64%)"},doctype:{color:"hsl(230, 8%, 24%)"},punctuation:{color:"hsl(230, 8%, 24%)"},entity:{color:"hsl(230, 8%, 24%)",cursor:"help"},"attr-name":{color:"hsl(35, 99%, 36%)"},"class-name":{color:"hsl(35, 99%, 36%)"},boolean:{color:"hsl(35, 99%, 36%)"},constant:{color:"hsl(35, 99%, 36%)"},number:{color:"hsl(35, 99%, 36%)"},atrule:{color:"hsl(35, 99%, 36%)"},keyword:{color:"hsl(301, 63%, 40%)"},property:{color:"hsl(5, 74%, 59%)"},tag:{color:"hsl(5, 74%, 59%)"},symbol:{color:"hsl(5, 74%, 59%)"},deleted:{color:"hsl(5, 74%, 59%)"},important:{color:"hsl(5, 74%, 59%)"},selector:{color:"hsl(119, 34%, 47%)"},string:{color:"hsl(119, 34%, 47%)"},char:{color:"hsl(119, 34%, 47%)"},builtin:{color:"hsl(119, 34%, 47%)"},inserted:{color:"hsl(119, 34%, 47%)"},regex:{color:"hsl(119, 34%, 47%)"},"attr-value":{color:"hsl(119, 34%, 47%)"},"attr-value > .token.punctuation":{color:"hsl(119, 34%, 47%)"},variable:{color:"hsl(221, 87%, 60%)"},operator:{color:"hsl(221, 87%, 60%)"},function:{color:"hsl(221, 87%, 60%)"},url:{color:"hsl(198, 99%, 37%)"},"attr-value > .token.punctuation.attr-equals":{color:"hsl(230, 8%, 24%)"},"special-attr > .token.attr-value > .token.value.css":{color:"hsl(230, 8%, 24%)"},".language-css .token.selector":{color:"hsl(5, 74%, 59%)"},".language-css .token.property":{color:"hsl(230, 8%, 24%)"},".language-css .token.function":{color:"hsl(198, 99%, 37%)"},".language-css .token.url > .token.function":{color:"hsl(198, 99%, 37%)"},".language-css .token.url > .token.string.url":{color:"hsl(119, 34%, 47%)"},".language-css .token.important":{color:"hsl(301, 63%, 40%)"},".language-css .token.atrule .token.rule":{color:"hsl(301, 63%, 40%)"},".language-javascript .token.operator":{color:"hsl(301, 63%, 40%)"},".language-javascript .token.template-string > .token.interpolation > .token.interpolation-punctuation.punctuation":{color:"hsl(344, 84%, 43%)"},".language-json .token.operator":{color:"hsl(230, 8%, 24%)"},".language-json .token.null.keyword":{color:"hsl(35, 99%, 36%)"},".language-markdown .token.url":{color:"hsl(230, 8%, 24%)"},".language-markdown .token.url > .token.operator":{color:"hsl(230, 8%, 24%)"},".language-markdown .token.url-reference.url > .token.string":{color:"hsl(230, 8%, 24%)"},".language-markdown .token.url > .token.content":{color:"hsl(221, 87%, 60%)"},".language-markdown .token.url > .token.url":{color:"hsl(198, 99%, 37%)"},".language-markdown .token.url-reference.url":{color:"hsl(198, 99%, 37%)"},".language-markdown .token.blockquote.punctuation":{color:"hsl(230, 4%, 64%)",fontStyle:"italic"},".language-markdown .token.hr.punctuation":{color:"hsl(230, 4%, 64%)",fontStyle:"italic"},".language-markdown .token.code-snippet":{color:"hsl(119, 34%, 47%)"},".language-markdown .token.bold .token.content":{color:"hsl(35, 99%, 36%)"},".language-markdown .token.italic .token.content":{color:"hsl(301, 63%, 40%)"},".language-markdown .token.strike .token.content":{color:"hsl(5, 74%, 59%)"},".language-markdown .token.strike .token.punctuation":{color:"hsl(5, 74%, 59%)"},".language-markdown .token.list.punctuation":{color:"hsl(5, 74%, 59%)"},".language-markdown .token.title.important > .token.punctuation":{color:"hsl(5, 74%, 59%)"},bold:{fontWeight:"bold"},italic:{fontStyle:"italic"},namespace:{Opacity:"0.8"},"token.tab:not(:empty):before":{color:"hsla(230, 8%, 24%, 0.2)"},"token.cr:before":{color:"hsla(230, 8%, 24%, 0.2)"},"token.lf:before":{color:"hsla(230, 8%, 24%, 0.2)"},"token.space:before":{color:"hsla(230, 8%, 24%, 0.2)"},"div.code-toolbar > .toolbar.toolbar > .toolbar-item":{marginRight:"0.4em"},"div.code-toolbar > .toolbar.toolbar > .toolbar-item > button":{background:"hsl(230, 1%, 90%)",color:"hsl(230, 6%, 44%)",padding:"0.1em 0.4em",borderRadius:"0.3em"},"div.code-toolbar > .toolbar.toolbar > .toolbar-item > a":{background:"hsl(230, 1%, 90%)",color:"hsl(230, 6%, 44%)",padding:"0.1em 0.4em",borderRadius:"0.3em"},"div.code-toolbar > .toolbar.toolbar > .toolbar-item > span":{background:"hsl(230, 1%, 90%)",color:"hsl(230, 6%, 44%)",padding:"0.1em 0.4em",borderRadius:"0.3em"},"div.code-toolbar > .toolbar.toolbar > .toolbar-item > button:hover":{background:"hsl(230, 1%, 78%)",color:"hsl(230, 8%, 24%)"},"div.code-toolbar > .toolbar.toolbar > .toolbar-item > button:focus":{background:"hsl(230, 1%, 78%)",color:"hsl(230, 8%, 24%)"},"div.code-toolbar > .toolbar.toolbar > .toolbar-item > a:hover":{background:"hsl(230, 1%, 78%)",color:"hsl(230, 8%, 24%)"},"div.code-toolbar > .toolbar.toolbar > .toolbar-item > a:focus":{background:"hsl(230, 1%, 78%)",color:"hsl(230, 8%, 24%)"},"div.code-toolbar > .toolbar.toolbar > .toolbar-item > span:hover":{background:"hsl(230, 1%, 78%)",color:"hsl(230, 8%, 24%)"},"div.code-toolbar > .toolbar.toolbar > .toolbar-item > span:focus":{background:"hsl(230, 1%, 78%)",color:"hsl(230, 8%, 24%)"},".line-highlight.line-highlight":{background:"hsla(230, 8%, 24%, 0.05)"},".line-highlight.line-highlight:before":{background:"hsl(230, 1%, 90%)",color:"hsl(230, 8%, 24%)",padding:"0.1em 0.6em",borderRadius:"0.3em",boxShadow:"0 2px 0 0 rgba(0, 0, 0, 0.2)"},".line-highlight.line-highlight[data-end]:after":{background:"hsl(230, 1%, 90%)",color:"hsl(230, 8%, 24%)",padding:"0.1em 0.6em",borderRadius:"0.3em",boxShadow:"0 2px 0 0 rgba(0, 0, 0, 0.2)"},"pre[id].linkable-line-numbers.linkable-line-numbers span.line-numbers-rows > span:hover:before":{backgroundColor:"hsla(230, 8%, 24%, 0.05)"},".line-numbers.line-numbers .line-numbers-rows":{borderRightColor:"hsla(230, 8%, 24%, 0.2)"},".command-line .command-line-prompt":{borderRightColor:"hsla(230, 8%, 24%, 0.2)"},".line-numbers .line-numbers-rows > span:before":{color:"hsl(230, 1%, 62%)"},".command-line .command-line-prompt > span:before":{color:"hsl(230, 1%, 62%)"},".rainbow-braces .token.token.punctuation.brace-level-1":{color:"hsl(5, 74%, 59%)"},".rainbow-braces .token.token.punctuation.brace-level-5":{color:"hsl(5, 74%, 59%)"},".rainbow-braces .token.token.punctuation.brace-level-9":{color:"hsl(5, 74%, 59%)"},".rainbow-braces .token.token.punctuation.brace-level-2":{color:"hsl(119, 34%, 47%)"},".rainbow-braces .token.token.punctuation.brace-level-6":{color:"hsl(119, 34%, 47%)"},".rainbow-braces .token.token.punctuation.brace-level-10":{color:"hsl(119, 34%, 47%)"},".rainbow-braces .token.token.punctuation.brace-level-3":{color:"hsl(221, 87%, 60%)"},".rainbow-braces .token.token.punctuation.brace-level-7":{color:"hsl(221, 87%, 60%)"},".rainbow-braces .token.token.punctuation.brace-level-11":{color:"hsl(221, 87%, 60%)"},".rainbow-braces .token.token.punctuation.brace-level-4":{color:"hsl(301, 63%, 40%)"},".rainbow-braces .token.token.punctuation.brace-level-8":{color:"hsl(301, 63%, 40%)"},".rainbow-braces .token.token.punctuation.brace-level-12":{color:"hsl(301, 63%, 40%)"},"pre.diff-highlight > code .token.token.deleted:not(.prefix)":{backgroundColor:"hsla(353, 100%, 66%, 0.15)"},"pre > code.diff-highlight .token.token.deleted:not(.prefix)":{backgroundColor:"hsla(353, 100%, 66%, 0.15)"},"pre.diff-highlight > code .token.token.deleted:not(.prefix)::-moz-selection":{backgroundColor:"hsla(353, 95%, 66%, 0.25)"},"pre.diff-highlight > code .token.token.deleted:not(.prefix) *::-moz-selection":{backgroundColor:"hsla(353, 95%, 66%, 0.25)"},"pre > code.diff-highlight .token.token.deleted:not(.prefix)::-moz-selection":{backgroundColor:"hsla(353, 95%, 66%, 0.25)"},"pre > code.diff-highlight .token.token.deleted:not(.prefix) *::-moz-selection":{backgroundColor:"hsla(353, 95%, 66%, 0.25)"},"pre.diff-highlight > code .token.token.deleted:not(.prefix)::selection":{backgroundColor:"hsla(353, 95%, 66%, 0.25)"},"pre.diff-highlight > code .token.token.deleted:not(.prefix) *::selection":{backgroundColor:"hsla(353, 95%, 66%, 0.25)"},"pre > code.diff-highlight .token.token.deleted:not(.prefix)::selection":{backgroundColor:"hsla(353, 95%, 66%, 0.25)"},"pre > code.diff-highlight .token.token.deleted:not(.prefix) *::selection":{backgroundColor:"hsla(353, 95%, 66%, 0.25)"},"pre.diff-highlight > code .token.token.inserted:not(.prefix)":{backgroundColor:"hsla(137, 100%, 55%, 0.15)"},"pre > code.diff-highlight .token.token.inserted:not(.prefix)":{backgroundColor:"hsla(137, 100%, 55%, 0.15)"},"pre.diff-highlight > code .token.token.inserted:not(.prefix)::-moz-selection":{backgroundColor:"hsla(135, 73%, 55%, 0.25)"},"pre.diff-highlight > code .token.token.inserted:not(.prefix) *::-moz-selection":{backgroundColor:"hsla(135, 73%, 55%, 0.25)"},"pre > code.diff-highlight .token.token.inserted:not(.prefix)::-moz-selection":{backgroundColor:"hsla(135, 73%, 55%, 0.25)"},"pre > code.diff-highlight .token.token.inserted:not(.prefix) *::-moz-selection":{backgroundColor:"hsla(135, 73%, 55%, 0.25)"},"pre.diff-highlight > code .token.token.inserted:not(.prefix)::selection":{backgroundColor:"hsla(135, 73%, 55%, 0.25)"},"pre.diff-highlight > code .token.token.inserted:not(.prefix) *::selection":{backgroundColor:"hsla(135, 73%, 55%, 0.25)"},"pre > code.diff-highlight .token.token.inserted:not(.prefix)::selection":{backgroundColor:"hsla(135, 73%, 55%, 0.25)"},"pre > code.diff-highlight .token.token.inserted:not(.prefix) *::selection":{backgroundColor:"hsla(135, 73%, 55%, 0.25)"},".prism-previewer.prism-previewer:before":{borderColor:"hsl(0, 0, 95%)"},".prism-previewer-gradient.prism-previewer-gradient div":{borderColor:"hsl(0, 0, 95%)",borderRadius:"0.3em"},".prism-previewer-color.prism-previewer-color:before":{borderRadius:"0.3em"},".prism-previewer-easing.prism-previewer-easing:before":{borderRadius:"0.3em"},".prism-previewer.prism-previewer:after":{borderTopColor:"hsl(0, 0, 95%)"},".prism-previewer-flipped.prism-previewer-flipped.after":{borderBottomColor:"hsl(0, 0, 95%)"},".prism-previewer-angle.prism-previewer-angle:before":{background:"hsl(0, 0%, 100%)"},".prism-previewer-time.prism-previewer-time:before":{background:"hsl(0, 0%, 100%)"},".prism-previewer-easing.prism-previewer-easing":{background:"hsl(0, 0%, 100%)"},".prism-previewer-angle.prism-previewer-angle circle":{stroke:"hsl(230, 8%, 24%)",strokeOpacity:"1"},".prism-previewer-time.prism-previewer-time circle":{stroke:"hsl(230, 8%, 24%)",strokeOpacity:"1"},".prism-previewer-easing.prism-previewer-easing circle":{stroke:"hsl(230, 8%, 24%)",fill:"transparent"},".prism-previewer-easing.prism-previewer-easing path":{stroke:"hsl(230, 8%, 24%)"},".prism-previewer-easing.prism-previewer-easing line":{stroke:"hsl(230, 8%, 24%)"}};function Be({article:e,onBack:t,onOpenLogin:r}){const{state:a,dispatch:o}=O(),{comments:s,currentTheme:l,isAuthenticated:g,currentUser:m,siteSettings:p}=a,[x,b]=h.useState(!1),[y,k]=h.useState(new Set),[f,v]=h.useState({author:(null==m?void 0:m.displayName)||"",email:(null==m?void 0:m.email)||"",content:""}),w=s.filter(t=>t.articleId===e.id);h.useEffect(()=>{const t=i(n({},e),{views:e.views+1});o({type:"UPDATE_ARTICLE",payload:t})},[e.id]);const j=e=>new Date(e).toLocaleDateString("zh-CN",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}),S=(e,t)=>d(this,null,function*(){try{yield navigator.clipboard.writeText(e),k(e=>new Set(e).add(t)),setTimeout(()=>{k(e=>{const r=new Set(e);return r.delete(t),r})},2e3)}catch(r){console.error("复制失败:",r)}});return u.jsx("div",{className:"min-h-screen transition-colors duration-300 "+("dark"===l?"text-white":"text-gray-800"),children:u.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-8",children:[u.jsxs("button",{onClick:t,className:"flex items-center space-x-2 mb-8 px-4 py-2 rounded-lg transition-all duration-300 hover:scale-105 "+("dark"===l?"bg-gray-800 text-gray-300 hover:bg-gray-700":"bg-gray-100 text-gray-600 hover:bg-gray-200"),children:[u.jsx(_,{size:20}),u.jsx("span",{children:"返回文章列表"})]}),u.jsxs("header",{className:"mb-8",children:[e.coverImage&&u.jsxs("div",{className:"relative h-64 md:h-80 rounded-xl overflow-hidden mb-6",children:[u.jsx("img",{src:e.coverImage,alt:e.title,className:"w-full h-full object-cover"}),u.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/50 to-transparent"})]}),u.jsx("h1",{className:"text-3xl md:text-4xl font-bold mb-4 "+("dark"===l?"text-white":"text-gray-800"),children:e.title}),u.jsxs("div",{className:"flex flex-wrap items-center gap-6 text-sm "+("dark"===l?"text-gray-400":"text-gray-500"),children:[u.jsxs("span",{className:"flex items-center",children:[u.jsx(I,{size:16,className:"mr-2"}),j(e.createdAt)]}),u.jsxs("span",{className:"flex items-center",children:[u.jsx(K,{size:16,className:"mr-2"}),e.views," 次阅读"]}),u.jsxs("button",{onClick:()=>{if(!x){const t=i(n({},e),{likes:e.likes+1});o({type:"UPDATE_ARTICLE",payload:t}),b(!0)}},className:`flex items-center space-x-1 transition-colors ${x?"text-red-500":""} hover:text-red-500`,children:[u.jsx(Y,{size:16,className:x?"fill-current":""}),u.jsx("span",{children:e.likes})]})]}),e.tags.length>0&&u.jsx("div",{className:"flex flex-wrap gap-2 mt-4",children:e.tags.map(e=>u.jsxs("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm "+("dark"===l?"bg-gray-700 text-gray-300":"bg-gray-100 text-gray-600"),children:[u.jsx(we,{size:14,className:"mr-1"}),e]},e))})]}),u.jsx("article",{className:"prose max-w-none mb-12 "+("dark"===l?"prose-invert":"prose-gray"),children:u.jsx(He,{components:{code(t){var r=t,{className:a,children:o}=r,s=c(r,["className","children"]);const d=/language-(\w+)/.exec(a||""),g=!(null==a?void 0:a.includes("language-")),h=String(o).replace(/\n$/,""),m=`${e.id}-${h.slice(0,20)}`,p=y.has(m);return!g&&d?u.jsxs("div",{className:"relative group",children:[u.jsxs("div",{className:"absolute top-2 right-2 z-10 flex items-center gap-2 "+("dark"===l?"text-gray-300":"text-gray-600"),children:[u.jsx("span",{className:"text-xs px-2 py-1 rounded "+("dark"===l?"bg-gray-700":"bg-gray-200"),children:d[1]}),u.jsx("button",{onClick:()=>S(h,m),className:"p-1.5 rounded transition-all hover:scale-110 opacity-0 group-hover:opacity-100 "+(p?"bg-green-500 text-white":"dark"===l?"bg-gray-700 hover:bg-gray-600 text-gray-300":"bg-gray-200 hover:bg-gray-300 text-gray-600"),title:p?"已复制!":"复制代码",children:p?u.jsx(D,{size:14}):u.jsx(F,{size:14})})]}),u.jsx(N,i(n({style:"dark"===l?Ge:Fe,language:d[1],PreTag:"div"},s),{children:h}))]}):u.jsx("code",i(n({className:a},s),{children:o}))}},children:e.content})}),u.jsxs("section",{className:"border-t pt-8 "+("dark"===l?"border-gray-700":"border-gray-200"),children:[u.jsxs("h3",{className:"text-2xl font-bold mb-6 flex items-center "+("dark"===l?"text-white":"text-gray-800"),children:[u.jsx(ae,{size:24,className:"mr-2"}),"评论 (",w.length,")"]}),p.requireLoginForComments&&!g?u.jsxs("div",{className:"mb-8 p-6 rounded-xl text-center "+("dark"===l?"bg-gray-800":"bg-gray-50"),children:[u.jsx(ee,{size:48,className:"mx-auto mb-4 "+("dark"===l?"text-gray-400":"text-gray-500")}),u.jsx("h4",{className:"text-lg font-semibold mb-2 "+("dark"===l?"text-gray-200":"text-gray-700"),children:"登录后参与讨论"}),u.jsx("p",{className:"mb-4 "+("dark"===l?"text-gray-400":"text-gray-600"),children:"请登录后发表评论，与其他读者分享你的看法"}),u.jsx("button",{onClick:r,className:"px-6 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors",children:"立即登录"})]}):u.jsxs("form",{onSubmit:t=>{if(t.preventDefault(),p.requireLoginForComments&&!g)return void(r?r():alert("请先登录后再发表评论"));if(!f.content.trim())return void alert("请输入评论内容");if(!g&&!f.author.trim())return void alert("请填写昵称");const a={id:Date.now().toString(),articleId:e.id,author:g?m.displayName:f.author.trim(),email:g?m.email:f.email.trim(),content:f.content.trim(),createdAt:(new Date).toISOString()};o({type:"ADD_COMMENT",payload:a}),v({author:g?m.displayName:"",email:g?m.email:"",content:""})},className:"mb-8 p-6 rounded-xl "+("dark"===l?"bg-gray-800":"bg-gray-50"),children:[!g&&u.jsxs("div",{className:"grid md:grid-cols-2 gap-4 mb-4",children:[u.jsx("input",{type:"text",placeholder:"昵称 *",value:f.author,onChange:e=>v(i(n({},f),{author:e.target.value})),className:"px-4 py-2 rounded-lg border transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 "+("dark"===l?"bg-gray-700 border-gray-600 text-white placeholder-gray-400":"bg-white border-gray-300 text-gray-800 placeholder-gray-500"),required:!0}),u.jsx("input",{type:"email",placeholder:"邮箱（可选）",value:f.email,onChange:e=>v(i(n({},f),{email:e.target.value})),className:"px-4 py-2 rounded-lg border transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 "+("dark"===l?"bg-gray-700 border-gray-600 text-white placeholder-gray-400":"bg-white border-gray-300 text-gray-800 placeholder-gray-500")})]}),g&&u.jsx("div",{className:"mb-4 p-3 rounded-lg "+("dark"===l?"bg-gray-700":"bg-blue-50"),children:u.jsxs("span",{className:"text-sm "+("dark"===l?"text-gray-300":"text-blue-700"),children:["以 ",u.jsx("strong",{children:null==m?void 0:m.displayName})," 的身份发表评论"]})}),u.jsx("textarea",{placeholder:"写下你的评论... *",value:f.content,onChange:e=>v(i(n({},f),{content:e.target.value})),rows:4,className:"w-full px-4 py-2 rounded-lg border transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none "+("dark"===l?"bg-gray-700 border-gray-600 text-white placeholder-gray-400":"bg-white border-gray-300 text-gray-800 placeholder-gray-500"),required:!0}),u.jsxs("button",{type:"submit",className:"mt-4 flex items-center space-x-2 px-6 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-all hover:scale-105",children:[u.jsx(me,{size:16}),u.jsx("span",{children:"发布评论"})]})]}),u.jsx("div",{className:"space-y-6",children:0===w.length?u.jsx("p",{className:"text-center py-8 "+("dark"===l?"text-gray-400":"text-gray-500"),children:"暂无评论，快来抢沙发吧！"}):w.map(e=>u.jsxs("div",{className:"p-4 rounded-xl transition-colors "+("dark"===l?"bg-gray-800":"bg-gray-50"),children:[u.jsxs("div",{className:"flex items-center justify-between mb-2",children:[u.jsx("h4",{className:"font-semibold "+("dark"===l?"text-white":"text-gray-800"),children:e.author}),u.jsx("time",{className:"text-sm "+("dark"===l?"text-gray-400":"text-gray-500"),children:j(e.createdAt)})]}),u.jsx("p",{className:""+("dark"===l?"text-gray-300":"text-gray-600"),children:e.content})]},e.id))})]})]})})}function Ve({onOpenAdmin:e}){const{state:t}=O(),{siteSettings:r,currentTheme:a}=t;return u.jsx("footer",{className:"border-t mt-16 transition-colors duration-300 "+("dark"===a?"bg-gray-900/50 border-gray-700":"bg-gray-50/80 border-gray-200"),children:u.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-8",children:[u.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center space-y-4 md:space-y-0",children:[u.jsxs("div",{className:"text-center md:text-left",children:[u.jsx("h3",{className:"text-lg font-semibold mb-2 "+("dark"===a?"text-white":"text-gray-800"),children:r.siteName}),u.jsx("p",{className:"text-sm "+("dark"===a?"text-gray-400":"text-gray-600"),children:r.siteDescription})]}),u.jsxs("div",{className:"text-center "+("dark"===a?"text-gray-400":"text-gray-600"),children:[u.jsxs("p",{className:"text-sm flex items-center justify-center",children:["Made with ",u.jsx(Y,{size:16,className:"mx-1 text-red-500"})," by ",r.siteAuthor]}),u.jsxs("p",{className:"text-xs mt-1",children:["© 2025 ",r.siteName,". All rights reserved."]})]}),u.jsxs("button",{onClick:e,className:"flex items-center space-x-2 px-4 py-2 rounded-lg text-sm transition-all duration-300 hover:scale-105 "+("dark"===a?"bg-gray-800 text-gray-300 hover:bg-gray-700":"bg-gray-200 text-gray-600 hover:bg-gray-300"),title:"站长设置",children:[u.jsx(pe,{size:16}),u.jsx("span",{children:"站长设置"})]})]}),u.jsx("div",{className:"mt-6 pt-6 border-t text-center text-xs "+("dark"===a?"border-gray-700 text-gray-500":"border-gray-300 text-gray-500"),children:u.jsx("p",{children:"Powered by React + TypeScript + Tailwind CSS"})})]})})}function Ke({onCaptchaChange:e,theme:t="light",className:r=""}){const[a,o]=h.useState({question:"",answer:""}),[s,l]=h.useState(""),n=()=>{const t=["+","-","*"];let r,a,s,n;switch(t[Math.floor(Math.random()*t.length)]){case"+":r=Math.floor(50*Math.random())+1,a=Math.floor(50*Math.random())+1,s=r+a,n=`${r} + ${a} = ?`;break;case"-":r=Math.floor(50*Math.random())+25,a=Math.floor(25*Math.random())+1,s=r-a,n=`${r} - ${a} = ?`;break;case"*":r=Math.floor(10*Math.random())+1,a=Math.floor(10*Math.random())+1,s=r*a,n=`${r} × ${a} = ?`;break;default:r=1,a=1,s=2,n="1 + 1 = ?"}o({question:n,answer:s.toString()}),l(""),e("",!1)};h.useEffect(()=>{n()},[]);const i=s.trim()===a.answer,c=s.trim().length>0;return u.jsxs("div",{className:`space-y-3 ${r}`,children:[u.jsx("label",{className:"block text-sm font-medium "+("dark"===t?"text-gray-300":"text-gray-700"),children:"人机验证"}),u.jsxs("div",{className:"flex items-center gap-3 p-4 rounded-lg border-2 transition-colors "+("dark"===t?"bg-gray-700 border-gray-600":"bg-gray-50 border-gray-200"),children:[u.jsx("div",{className:`flex-1 text-center py-2 px-4 rounded font-mono text-lg ${"dark"===t?"bg-gray-800 text-gray-200 border-gray-600":"bg-white text-gray-800 border-gray-300"} border`,children:a.question}),u.jsx("input",{type:"number",value:s,onChange:t=>(t=>{l(t);const r=t.trim()===a.answer;e(t,r)})(t.target.value),className:"w-20 px-3 py-2 text-center rounded border transition-all focus:outline-none focus:ring-2 "+(c?i?"border-green-500 bg-green-50 text-green-800 focus:ring-green-500":"border-red-500 bg-red-50 text-red-800 focus:ring-red-500":"dark"===t?"bg-gray-800 border-gray-600 text-white focus:ring-blue-500":"bg-white border-gray-300 text-gray-800 focus:ring-blue-500"),placeholder:"?"}),u.jsx("button",{type:"button",onClick:n,className:"p-2 rounded transition-colors "+("dark"===t?"text-gray-400 hover:text-white hover:bg-gray-600":"text-gray-500 hover:text-gray-700 hover:bg-gray-200"),title:"刷新验证码",children:u.jsx(de,{size:18})})]}),c&&u.jsxs("div",{className:"text-sm flex items-center gap-2 "+(i?"text-green-600":"text-red-600"),children:[u.jsx("div",{className:"w-2 h-2 rounded-full "+(i?"bg-green-500":"bg-red-500")}),i?"验证通过":"答案错误，请重试"]})]})}function We({isOpen:e,onClose:t,mode:r="user"}){const{state:a,dispatch:o}=O(),{currentTheme:s,users:l}=a,[c,g]=h.useState("login"),[m,p]=h.useState(!1),[x,b]=h.useState(!1),[y,k]=h.useState(""),[f,v]=h.useState(!1),[w,j]=h.useState(""),[N,S]=h.useState(!1),[C,T]=h.useState({username:"",password:"",captcha:""}),[z,M]=h.useState({username:"",password:"",confirmPassword:"",displayName:"",email:"",captcha:""}),A=(e,t)=>{j(e),S(t),"login"===c?T(t=>i(n({},t),{captcha:e})):M(t=>i(n({},t),{captcha:e}))},L=()=>{T({username:"",password:"",captcha:""}),M({username:"",password:"",confirmPassword:"",displayName:"",email:"",captcha:""}),j(""),S(!1),k("")};return e?u.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-center justify-center p-4",children:u.jsxs("div",{className:"relative w-full max-w-md rounded-xl shadow-2xl transition-all duration-300 "+("dark"===s?"bg-gray-800":"bg-white"),children:[u.jsx("button",{onClick:()=>{t(),L()},className:"absolute top-4 right-4 p-2 rounded-full transition-colors "+("dark"===s?"text-gray-400 hover:text-white hover:bg-gray-700":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"),children:u.jsx(Re,{size:20})}),u.jsxs("div",{className:"p-8",children:[u.jsxs("div",{className:"text-center mb-6",children:[u.jsx("h2",{className:"text-2xl font-bold mb-2 "+("dark"===s?"text-white":"text-gray-800"),children:"admin"===r?"站长登录":"用户登录"}),u.jsx("p",{className:"text-sm "+("dark"===s?"text-gray-400":"text-gray-600"),children:"admin"===r?"请输入管理员账号密码":"登录或注册账号以使用完整功能"})]}),"user"===r&&u.jsxs("div",{className:"flex rounded-lg p-1 mb-6 "+("dark"===s?"bg-gray-700":"bg-gray-100"),children:[u.jsxs("button",{onClick:()=>g("login"),className:"flex-1 flex items-center justify-center gap-2 py-2 px-4 rounded-md text-sm font-medium transition-all "+("login"===c?"dark"===s?"bg-gray-600 text-white":"bg-white text-gray-800 shadow-sm":"dark"===s?"text-gray-300 hover:text-white":"text-gray-600 hover:text-gray-800"),children:[u.jsx(ee,{size:16}),"登录"]}),u.jsxs("button",{onClick:()=>g("register"),className:"flex-1 flex items-center justify-center gap-2 py-2 px-4 rounded-md text-sm font-medium transition-all "+("register"===c?"dark"===s?"bg-gray-600 text-white":"bg-white text-gray-800 shadow-sm":"dark"===s?"text-gray-300 hover:text-white":"text-gray-600 hover:text-gray-800"),children:[u.jsx(Te,{size:16}),"注册"]})]}),("admin"===r||"login"===c)&&u.jsxs("form",{onSubmit:e=>d(this,null,function*(){if(e.preventDefault(),k(""),v(!0),!N)return k("请完成人机验证"),void v(!1);yield new Promise(e=>setTimeout(e,1e3));const a=l.find(e=>e.username===C.username&&e.isActive);if(a){(yield function(e,t){return d(this,null,function*(){return(yield E(e))===t})}(C.password,a.password))?"admin"===r&&"admin"!==a.role?k("没有管理员权限"):(o({type:"LOGIN",payload:a}),t(),L()):k("用户名或密码错误")}else k("用户名或密码错误");v(!1)}),className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium mb-2 "+("dark"===s?"text-gray-300":"text-gray-700"),children:"用户名"}),u.jsxs("div",{className:"relative",children:[u.jsx(Ee,{size:18,className:"absolute left-3 top-1/2 transform -translate-y-1/2 "+("dark"===s?"text-gray-400":"text-gray-500")}),u.jsx("input",{type:"text",value:C.username,onChange:e=>T(t=>i(n({},t),{username:e.target.value})),className:"w-full pl-10 pr-4 py-3 rounded-lg border transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 "+("dark"===s?"bg-gray-700 border-gray-600 text-white placeholder-gray-400":"bg-gray-50 border-gray-300 text-gray-800 placeholder-gray-500"),placeholder:"请输入用户名",required:!0})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium mb-2 "+("dark"===s?"text-gray-300":"text-gray-700"),children:"密码"}),u.jsxs("div",{className:"relative",children:[u.jsx(X,{size:18,className:"absolute left-3 top-1/2 transform -translate-y-1/2 "+("dark"===s?"text-gray-400":"text-gray-500")}),u.jsx("input",{type:m?"text":"password",value:C.password,onChange:e=>T(t=>i(n({},t),{password:e.target.value})),className:"w-full pl-10 pr-12 py-3 rounded-lg border transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 "+("dark"===s?"bg-gray-700 border-gray-600 text-white placeholder-gray-400":"bg-gray-50 border-gray-300 text-gray-800 placeholder-gray-500"),placeholder:"请输入密码",required:!0}),u.jsx("button",{type:"button",onClick:()=>p(!m),className:"absolute right-3 top-1/2 transform -translate-y-1/2 "+("dark"===s?"text-gray-400 hover:text-white":"text-gray-500 hover:text-gray-700"),children:m?u.jsx(V,{size:18}):u.jsx(K,{size:18})})]})]}),u.jsx(Ke,{onCaptchaChange:A,theme:s}),y&&u.jsx("div",{className:"p-3 rounded-lg bg-red-500/10 border border-red-500/20",children:u.jsx("p",{className:"text-red-500 text-sm",children:y})}),u.jsx("button",{type:"submit",disabled:f||!N,className:`w-full py-3 rounded-lg font-medium transition-all duration-300 ${f||!N?"bg-gray-400 cursor-not-allowed":"bg-blue-500 hover:bg-blue-600 transform hover:scale-[1.02]"} text-white`,children:f?"登录中...":"登录"})]}),"user"===r&&"register"===c&&u.jsxs("form",{onSubmit:e=>d(this,null,function*(){if(e.preventDefault(),k(""),v(!0),!N)return k("请完成人机验证"),void v(!1);if(z.password!==z.confirmPassword)return k("两次输入的密码不一致"),void v(!1);if(z.password.length<6)return k("密码长度至少6位"),void v(!1);if(l.some(e=>e.username===z.username))return k("用户名已存在"),void v(!1);if(l.some(e=>e.email===z.email))return k("邮箱已被注册"),void v(!1);yield new Promise(e=>setTimeout(e,1e3));const r=yield E(z.password),a={id:Date.now().toString()+Math.random().toString(36).substr(2,9),username:z.username,password:r,displayName:z.displayName||z.username,email:z.email,bio:"",role:"user",createdAt:(new Date).toISOString(),isActive:!0};o({type:"REGISTER_USER",payload:a}),o({type:"LOGIN",payload:a}),t(),L(),v(!1)}),className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium mb-2 "+("dark"===s?"text-gray-300":"text-gray-700"),children:"用户名"}),u.jsxs("div",{className:"relative",children:[u.jsx(Ee,{size:18,className:"absolute left-3 top-1/2 transform -translate-y-1/2 "+("dark"===s?"text-gray-400":"text-gray-500")}),u.jsx("input",{type:"text",value:z.username,onChange:e=>M(t=>i(n({},t),{username:e.target.value})),className:"w-full pl-10 pr-4 py-3 rounded-lg border transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 "+("dark"===s?"bg-gray-700 border-gray-600 text-white placeholder-gray-400":"bg-gray-50 border-gray-300 text-gray-800 placeholder-gray-500"),placeholder:"设置用户名",required:!0})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium mb-2 "+("dark"===s?"text-gray-300":"text-gray-700"),children:"显示名称"}),u.jsxs("div",{className:"relative",children:[u.jsx(Ee,{size:18,className:"absolute left-3 top-1/2 transform -translate-y-1/2 "+("dark"===s?"text-gray-400":"text-gray-500")}),u.jsx("input",{type:"text",value:z.displayName,onChange:e=>M(t=>i(n({},t),{displayName:e.target.value})),className:"w-full pl-10 pr-4 py-3 rounded-lg border transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 "+("dark"===s?"bg-gray-700 border-gray-600 text-white placeholder-gray-400":"bg-gray-50 border-gray-300 text-gray-800 placeholder-gray-500"),placeholder:"设置显示名称（可选）"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium mb-2 "+("dark"===s?"text-gray-300":"text-gray-700"),children:"邮箱"}),u.jsxs("div",{className:"relative",children:[u.jsx(re,{size:18,className:"absolute left-3 top-1/2 transform -translate-y-1/2 "+("dark"===s?"text-gray-400":"text-gray-500")}),u.jsx("input",{type:"email",value:z.email,onChange:e=>M(t=>i(n({},t),{email:e.target.value})),className:"w-full pl-10 pr-4 py-3 rounded-lg border transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 "+("dark"===s?"bg-gray-700 border-gray-600 text-white placeholder-gray-400":"bg-gray-50 border-gray-300 text-gray-800 placeholder-gray-500"),placeholder:"请输入邮箱地址",required:!0})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium mb-2 "+("dark"===s?"text-gray-300":"text-gray-700"),children:"密码"}),u.jsxs("div",{className:"relative",children:[u.jsx(X,{size:18,className:"absolute left-3 top-1/2 transform -translate-y-1/2 "+("dark"===s?"text-gray-400":"text-gray-500")}),u.jsx("input",{type:m?"text":"password",value:z.password,onChange:e=>M(t=>i(n({},t),{password:e.target.value})),className:"w-full pl-10 pr-12 py-3 rounded-lg border transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 "+("dark"===s?"bg-gray-700 border-gray-600 text-white placeholder-gray-400":"bg-gray-50 border-gray-300 text-gray-800 placeholder-gray-500"),placeholder:"设置密码（至少6位）",required:!0}),u.jsx("button",{type:"button",onClick:()=>p(!m),className:"absolute right-3 top-1/2 transform -translate-y-1/2 "+("dark"===s?"text-gray-400 hover:text-white":"text-gray-500 hover:text-gray-700"),children:m?u.jsx(V,{size:18}):u.jsx(K,{size:18})})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium mb-2 "+("dark"===s?"text-gray-300":"text-gray-700"),children:"确认密码"}),u.jsxs("div",{className:"relative",children:[u.jsx(X,{size:18,className:"absolute left-3 top-1/2 transform -translate-y-1/2 "+("dark"===s?"text-gray-400":"text-gray-500")}),u.jsx("input",{type:x?"text":"password",value:z.confirmPassword,onChange:e=>M(t=>i(n({},t),{confirmPassword:e.target.value})),className:"w-full pl-10 pr-12 py-3 rounded-lg border transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 "+("dark"===s?"bg-gray-700 border-gray-600 text-white placeholder-gray-400":"bg-gray-50 border-gray-300 text-gray-800 placeholder-gray-500"),placeholder:"再次输入密码",required:!0}),u.jsx("button",{type:"button",onClick:()=>b(!x),className:"absolute right-3 top-1/2 transform -translate-y-1/2 "+("dark"===s?"text-gray-400 hover:text-white":"text-gray-500 hover:text-gray-700"),children:x?u.jsx(V,{size:18}):u.jsx(K,{size:18})})]})]}),u.jsx(Ke,{onCaptchaChange:A,theme:s}),y&&u.jsx("div",{className:"p-3 rounded-lg bg-red-500/10 border border-red-500/20",children:u.jsx("p",{className:"text-red-500 text-sm",children:y})}),u.jsx("button",{type:"submit",disabled:f||!N,className:`w-full py-3 rounded-lg font-medium transition-all duration-300 ${f||!N?"bg-gray-400 cursor-not-allowed":"bg-green-500 hover:bg-green-600 transform hover:scale-[1.02]"} text-white`,children:f?"注册中...":"注册"})]})]})]})}):null}class Ze{constructor(e){var t,r;l(this,"symbol"!=typeof(t="config")?t+"":t,r),this.config=e}apiRequest(e){return d(this,arguments,function*(e,t={}){const r=`https://api.github.com/repos/${this.config.owner}/${this.config.repo}/${e}`,a=yield fetch(r,i(n({},t),{headers:n({Authorization:`token ${this.config.token}`,Accept:"application/vnd.github.v3+json","Content-Type":"application/json"},t.headers)}));if(!a.ok)throw new Error(`GitHub API error: ${a.status} ${a.statusText}`);return a.json()})}checkFileExists(e){return d(this,null,function*(){try{return yield this.apiRequest(`contents/${e}?ref=${this.config.branch}`),!0}catch(t){return!1}})}getFile(e){return d(this,null,function*(){try{const t=yield this.apiRequest(`contents/${e}?ref=${this.config.branch}`),r=atob(t.content.replace(/\s/g,""));return JSON.parse(r)}catch(t){return console.error("Failed to get file from GitHub:",t),null}})}saveFile(e,t,r){return d(this,null,function*(){const a=btoa(JSON.stringify(t,null,2));let o;try{o=(yield this.apiRequest(`contents/${e}?ref=${this.config.branch}`)).sha}catch(s){}yield this.apiRequest(`contents/${e}`,{method:"PUT",body:JSON.stringify(n({message:r,content:a,branch:this.config.branch},o&&{sha:o}))})})}syncToGitHub(e){return d(this,null,function*(){const t=(new Date).toISOString(),r=i(n({},e),{lastUpdated:t});yield this.saveFile("blog-data.json",r,`Update blog data - ${t}`)})}syncFromGitHub(){return d(this,null,function*(){return yield this.getFile("blog-data.json")})}uploadImage(e,t){return d(this,null,function*(){const r=new FileReader;return new Promise((a,o)=>{r.onload=()=>d(this,null,function*(){try{const e=r.result.split(",")[1],o=`images/${t}`;yield this.apiRequest(`contents/${o}`,{method:"PUT",body:JSON.stringify({message:`Upload image: ${t}`,content:e,branch:this.config.branch})});const s=`https://raw.githubusercontent.com/${this.config.owner}/${this.config.repo}/${this.config.branch}/${o}`;a(s)}catch(e){o(e)}}),r.onerror=()=>o(new Error("Failed to read file")),r.readAsDataURL(e)})})}uploadAudio(e,t){return d(this,null,function*(){const r=new FileReader;return new Promise((a,o)=>{r.onload=()=>d(this,null,function*(){try{const e=r.result.split(",")[1],o=`music/${t}`;yield this.apiRequest(`contents/${o}`,{method:"PUT",body:JSON.stringify({message:`Upload audio: ${t}`,content:e,branch:this.config.branch})});const s=`https://raw.githubusercontent.com/${this.config.owner}/${this.config.repo}/${this.config.branch}/${o}`;a(s)}catch(e){o(e)}}),r.onerror=()=>o(new Error("Failed to read file")),r.readAsDataURL(e)})})}}let Ye=null;function Je(){return Ye}function Qe({isOpen:e,onClose:t}){const{state:r,dispatch:a}=O(),{articles:o,users:s,siteSettings:l,currentTheme:c,isAuthenticated:g,musicTracks:m,currentTrack:p,isPlaying:x,gitHubConfig:b,lastSyncTime:y}=r,[k,f]=h.useState("articles"),[v,j]=h.useState(null),[N,S]=h.useState(!1),[C,T]=h.useState("idle"),z=h.useRef(null),E=h.useRef(null),[M,A]=h.useState({title:"",content:"",summary:"",tags:"",published:!1,coverImage:""}),[L,R]=h.useState({siteName:l.siteName,siteDescription:l.siteDescription,siteAuthor:l.siteAuthor,currentBackground:l.currentBackground,github:l.socialLinks.github||"",twitter:l.socialLinks.twitter||"",weibo:l.socialLinks.weibo||"",email:l.socialLinks.email||"",bilibili:l.socialLinks.bilibili||"",wechat:l.socialLinks.wechat||"",qq:l.socialLinks.qq||"",musicEnabled:l.musicSettings.isEnabled,autoPlay:l.musicSettings.autoPlay,autoPlayOnPageLoad:l.musicSettings.autoPlayConditions.includes("onPageLoad"),autoPlayOnArticleOpen:l.musicSettings.autoPlayConditions.includes("onArticleOpen"),playMode:l.musicSettings.playMode,volume:l.musicSettings.volume,requireLoginForComments:l.requireLoginForComments}),[P,$]=h.useState({owner:(null==b?void 0:b.owner)||"",repo:(null==b?void 0:b.repo)||"",token:(null==b?void 0:b.token)||"",branch:(null==b?void 0:b.branch)||"main"});if(!e||!g)return null;return u.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50",children:u.jsxs("div",{className:"h-full flex "+("dark"===c?"text-white":"text-gray-800"),children:[u.jsxs("div",{className:`w-64 p-6 ${"dark"===c?"bg-gray-800":"bg-white"} border-r ${"dark"===c?"border-gray-700":"border-gray-200"} overflow-y-auto`,children:[u.jsxs("div",{className:"flex items-center justify-between mb-8",children:[u.jsx("h2",{className:"text-xl font-bold",children:"管理后台"}),u.jsx("button",{onClick:t,className:"p-2 rounded-lg transition-colors "+("dark"===c?"hover:bg-gray-700 text-gray-400":"hover:bg-gray-100 text-gray-500"),children:u.jsx(Re,{size:20})})]}),u.jsxs("nav",{className:"space-y-2",children:[u.jsxs("button",{onClick:()=>f("articles"),className:"w-full text-left px-4 py-3 rounded-lg transition-colors flex items-center gap-3 "+("articles"===k?"bg-blue-500 text-white":"dark"===c?"hover:bg-gray-700 text-gray-300":"hover:bg-gray-100 text-gray-600"),children:[u.jsx(W,{size:18}),"文章管理"]}),u.jsxs("button",{onClick:()=>f("users"),className:"w-full text-left px-4 py-3 rounded-lg transition-colors flex items-center gap-3 "+("users"===k?"bg-blue-500 text-white":"dark"===c?"hover:bg-gray-700 text-gray-300":"hover:bg-gray-100 text-gray-600"),children:[u.jsx(Me,{size:18}),"用户管理"]}),u.jsxs("button",{onClick:()=>f("music"),className:"w-full text-left px-4 py-3 rounded-lg transition-colors flex items-center gap-3 "+("music"===k?"bg-blue-500 text-white":"dark"===c?"hover:bg-gray-700 text-gray-300":"hover:bg-gray-100 text-gray-600"),children:[u.jsx(le,{size:18}),"音乐管理"]}),u.jsxs("button",{onClick:()=>f("settings"),className:"w-full text-left px-4 py-3 rounded-lg transition-colors flex items-center gap-3 "+("settings"===k?"bg-blue-500 text-white":"dark"===c?"hover:bg-gray-700 text-gray-300":"hover:bg-gray-100 text-gray-600"),children:[u.jsx(pe,{size:18}),"网站设置"]}),u.jsxs("button",{onClick:()=>f("github"),className:"w-full text-left px-4 py-3 rounded-lg transition-colors flex items-center gap-3 "+("github"===k?"bg-blue-500 text-white":"dark"===c?"hover:bg-gray-700 text-gray-300":"hover:bg-gray-100 text-gray-600"),children:[u.jsx(Z,{size:18}),"数据同步"]})]}),u.jsxs("button",{onClick:()=>{window.confirm("确定要退出登录吗？")&&(a({type:"LOGOUT"}),t())},className:"w-full mt-8 flex items-center gap-3 px-4 py-3 rounded-lg transition-colors "+("dark"===c?"text-red-400 hover:bg-gray-700":"text-red-600 hover:bg-gray-100"),children:[u.jsx(te,{size:18}),"退出登录"]})]}),u.jsxs("div",{className:`flex-1 p-6 ${"dark"===c?"bg-gray-900":"bg-gray-50"} overflow-y-auto`,children:["articles"===k&&u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("h3",{className:"text-2xl font-bold",children:"文章管理"}),u.jsxs("button",{onClick:()=>{S(!0),j(null),A({title:"",content:"",summary:"",tags:"",published:!1,coverImage:""})},className:"flex items-center gap-2 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors",children:[u.jsx(ce,{size:18}),"新建文章"]})]}),N||v?u.jsx("div",{className:`p-6 rounded-lg ${"dark"===c?"bg-gray-800":"bg-white"} border ${"dark"===c?"border-gray-700":"border-gray-200"}`,children:u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium mb-2",children:"文章标题"}),u.jsx("input",{type:"text",value:M.title,onChange:e=>A(t=>i(n({},t),{title:e.target.value})),className:`w-full px-4 py-2 rounded-lg border ${"dark"===c?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-800"} focus:outline-none focus:ring-2 focus:ring-blue-500`,placeholder:"请输入文章标题"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium mb-2",children:"文章摘要"}),u.jsx("textarea",{value:M.summary,onChange:e=>A(t=>i(n({},t),{summary:e.target.value})),className:`w-full px-4 py-2 rounded-lg border ${"dark"===c?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-800"} focus:outline-none focus:ring-2 focus:ring-blue-500`,rows:3,placeholder:"请输入文章摘要（可选，留空将自动生成）"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium mb-2",children:"标签"}),u.jsx("input",{type:"text",value:M.tags,onChange:e=>A(t=>i(n({},t),{tags:e.target.value})),className:`w-full px-4 py-2 rounded-lg border ${"dark"===c?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-800"} focus:outline-none focus:ring-2 focus:ring-blue-500`,placeholder:"请输入标签，用逗号分隔"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium mb-2",children:"封面图片URL"}),u.jsx("input",{type:"url",value:M.coverImage,onChange:e=>A(t=>i(n({},t),{coverImage:e.target.value})),className:`w-full px-4 py-2 rounded-lg border ${"dark"===c?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-800"} focus:outline-none focus:ring-2 focus:ring-blue-500`,placeholder:"请输入封面图片URL（可选）"})]}),u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("input",{type:"checkbox",id:"published",checked:M.published,onChange:e=>A(t=>i(n({},t),{published:e.target.checked})),className:"w-4 h-4 text-blue-600 rounded focus:ring-blue-500"}),u.jsx("label",{htmlFor:"published",className:"text-sm font-medium",children:"立即发布"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium mb-2",children:"文章内容"}),u.jsx("div",{"data-color-mode":c,children:u.jsx(w,{value:M.content,onChange:e=>A(t=>i(n({},t),{content:e||""})),preview:"edit",height:400})})]}),u.jsxs("div",{className:"flex gap-3",children:[u.jsxs("button",{onClick:()=>{if(!M.title.trim()||!M.content.trim())return void alert("请填写标题和内容");const e=M.tags.split(",").map(e=>e.trim()).filter(e=>e.length>0);if(N){const t={id:Date.now().toString(),title:M.title.trim(),content:M.content.trim(),summary:M.summary.trim()||M.content.slice(0,150)+"...",tags:e,createdAt:(new Date).toISOString(),updatedAt:(new Date).toISOString(),views:0,likes:0,published:M.published,coverImage:M.coverImage.trim()||l.backgroundImages[0]};a({type:"ADD_ARTICLE",payload:t})}else if(v){const t=i(n({},v),{title:M.title.trim(),content:M.content.trim(),summary:M.summary.trim()||M.content.slice(0,150)+"...",tags:e,updatedAt:(new Date).toISOString(),published:M.published,coverImage:M.coverImage.trim()||v.coverImage});a({type:"UPDATE_ARTICLE",payload:t})}S(!1),j(null)},className:"flex items-center gap-2 px-6 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors",children:[u.jsx(he,{size:18}),"保存文章"]}),u.jsx("button",{onClick:()=>{S(!1),j(null)},className:"px-6 py-2 rounded-lg border transition-colors "+("dark"===c?"border-gray-600 text-gray-300 hover:bg-gray-700":"border-gray-300 text-gray-600 hover:bg-gray-100"),children:"取消"})]})]})}):u.jsxs("div",{className:"space-y-4",children:[o.map(e=>u.jsx("div",{className:`p-4 rounded-lg border ${"dark"===c?"bg-gray-800 border-gray-700":"bg-white border-gray-200"} hover:shadow-md transition-shadow`,children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"flex-1",children:[u.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[u.jsx("h4",{className:"text-lg font-semibold",children:e.title}),u.jsx("span",{className:"flex items-center gap-1 px-2 py-1 rounded-full text-xs "+(e.published?"bg-green-100 text-green-800":"bg-gray-100 text-gray-600"),children:e.published?u.jsxs(u.Fragment,{children:[u.jsx(K,{size:12}),"已发布"]}):u.jsxs(u.Fragment,{children:[u.jsx(V,{size:12}),"草稿"]})})]}),u.jsx("p",{className:"text-sm "+("dark"===c?"text-gray-400":"text-gray-600"),children:e.summary}),u.jsxs("div",{className:"flex items-center gap-4 mt-2 text-xs text-gray-500",children:[u.jsxs("span",{children:["创建时间：",new Date(e.createdAt).toLocaleString()]}),u.jsxs("span",{children:["标签：",e.tags.join(", ")]}),u.jsxs("span",{children:["阅读量：",e.views]})]})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("button",{onClick:()=>(e=>{j(e),S(!1),A({title:e.title,content:e.content,summary:e.summary,tags:e.tags.join(", "),published:e.published,coverImage:e.coverImage||""})})(e),className:"p-2 rounded-lg transition-colors "+("dark"===c?"text-blue-400 hover:bg-gray-700":"text-blue-600 hover:bg-blue-50"),children:u.jsx(fe,{size:16})}),u.jsx("button",{onClick:()=>{return t=e.id,void(window.confirm("确定要删除这篇文章吗？")&&a({type:"DELETE_ARTICLE",payload:t}));var t},className:"p-2 rounded-lg transition-colors "+("dark"===c?"text-red-400 hover:bg-gray-700":"text-red-600 hover:bg-red-50"),children:u.jsx(je,{size:16})})]})]})},e.id)),0===o.length&&u.jsxs("div",{className:"text-center py-12 "+("dark"===c?"text-gray-400":"text-gray-600"),children:[u.jsx(W,{size:48,className:"mx-auto mb-4 opacity-50"}),u.jsx("p",{children:"还没有文章，点击上方按钮创建第一篇文章吧！"})]})]})]}),"users"===k&&u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("h3",{className:"text-2xl font-bold",children:"用户管理"}),u.jsxs("div",{className:"text-sm text-gray-500",children:["共 ",s.length," 个用户"]})]}),u.jsxs("div",{className:"grid gap-4",children:[s.map(e=>u.jsx("div",{className:`p-4 rounded-lg border ${"dark"===c?"bg-gray-800 border-gray-700":"bg-white border-gray-200"} hover:shadow-md transition-shadow`,children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center ${"admin"===e.role?"bg-blue-500":"bg-gray-500"} text-white font-bold`,children:e.displayName.charAt(0).toUpperCase()}),u.jsxs("div",{children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("h4",{className:"font-semibold",children:e.displayName}),u.jsx("span",{className:"px-2 py-1 rounded-full text-xs "+("admin"===e.role?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-600"),children:"admin"===e.role?"管理员":"普通用户"}),u.jsx("span",{className:"px-2 py-1 rounded-full text-xs "+(e.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:e.isActive?"活跃":"禁用"})]}),u.jsxs("p",{className:"text-sm text-gray-500",children:["@",e.username," • ",e.email]}),u.jsxs("p",{className:"text-xs text-gray-400",children:["注册时间：",new Date(e.createdAt).toLocaleString()]})]})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("button",{onClick:()=>(e=>{const t=s.find(t=>t.id===e);if(t){const e="admin"===t.role?"user":"admin",r=i(n({},t),{role:e});a({type:"UPDATE_USER",payload:r})}})(e.id),className:"p-2 rounded-lg transition-colors "+("dark"===c?"text-blue-400 hover:bg-gray-700":"text-blue-600 hover:bg-blue-50"),title:"admin"===e.role?"降级为普通用户":"升级为管理员",children:"admin"===e.role?u.jsx(xe,{size:16}):u.jsx(Q,{size:16})}),u.jsx("button",{onClick:()=>(e=>{const t=s.find(t=>t.id===e);if(t){const e=i(n({},t),{isActive:!t.isActive});a({type:"UPDATE_USER",payload:e})}})(e.id),className:"p-2 rounded-lg transition-colors "+(e.isActive?"dark"===c?"text-red-400 hover:bg-gray-700":"text-red-600 hover:bg-red-50":"dark"===c?"text-green-400 hover:bg-gray-700":"text-green-600 hover:bg-green-50"),title:e.isActive?"禁用用户":"启用用户",children:e.isActive?u.jsx(ze,{size:16}):u.jsx(Ce,{size:16})}),u.jsx("button",{onClick:()=>{return t=e.id,void(window.confirm("确定要删除这个用户吗？")&&a({type:"DELETE_USER",payload:t}));var t},className:"p-2 rounded-lg transition-colors "+("dark"===c?"text-red-400 hover:bg-gray-700":"text-red-600 hover:bg-red-50"),title:"删除用户",children:u.jsx(je,{size:16})})]})]})},e.id)),0===s.length&&u.jsxs("div",{className:"text-center py-12 "+("dark"===c?"text-gray-400":"text-gray-600"),children:[u.jsx(Me,{size:48,className:"mx-auto mb-4 opacity-50"}),u.jsx("p",{children:"还没有注册用户"})]})]})]}),"music"===k&&u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("h3",{className:"text-2xl font-bold",children:"音乐管理"}),u.jsxs("button",{onClick:()=>{var e;return null==(e=z.current)?void 0:e.click()},className:"flex items-center gap-2 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors",children:[u.jsx(Se,{size:18}),"上传音乐"]})]}),u.jsx("input",{ref:z,type:"file",accept:"audio/*",onChange:e=>d(this,null,function*(){var t;const r=null==(t=e.target.files)?void 0:t[0];if(!r)return;const o=new Audio,s=URL.createObjectURL(r);o.onloadedmetadata=()=>{const e={id:Date.now().toString(),title:r.name.replace(/\.[^/.]+$/,""),artist:"未知艺术家",url:s,duration:o.duration,uploadedAt:(new Date).toISOString()};a({type:"ADD_MUSIC_TRACK",payload:e}),URL.revokeObjectURL(s)},o.src=s}),className:"hidden"}),u.jsxs("div",{className:"grid gap-4",children:[m.map(e=>u.jsx("div",{className:`p-4 rounded-lg border ${"dark"===c?"bg-gray-800 border-gray-700":"bg-white border-gray-200"} hover:shadow-md transition-shadow`,children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center gap-4",children:[u.jsx("div",{className:"w-12 h-12 rounded-lg flex items-center justify-center "+((null==p?void 0:p.id)===e.id&&x?"bg-blue-500 text-white":"dark"===c?"bg-gray-700 text-gray-300":"bg-gray-100 text-gray-600"),children:u.jsx(le,{size:20})}),u.jsxs("div",{children:[u.jsx("h4",{className:"font-semibold",children:e.title}),u.jsx("p",{className:"text-sm text-gray-500",children:e.artist}),u.jsxs("p",{className:"text-xs text-gray-400",children:["时长：",Math.floor(e.duration/60),":",Math.floor(e.duration%60).toString().padStart(2,"0")," • 上传时间：",new Date(e.uploadedAt).toLocaleString()]})]})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("button",{onClick:()=>{(null==p?void 0:p.id)===e.id?a({type:"SET_PLAYING",payload:!x}):(a({type:"SET_CURRENT_TRACK",payload:e}),a({type:"SET_PLAYING",payload:!0}))},className:"p-2 rounded-lg transition-colors "+("dark"===c?"text-blue-400 hover:bg-gray-700":"text-blue-600 hover:bg-blue-50"),children:(null==p?void 0:p.id)===e.id&&x?u.jsx(ne,{size:16}):u.jsx(ie,{size:16})}),u.jsx("button",{onClick:()=>{return t=e.id,void(window.confirm("确定要删除这首音乐吗？")&&a({type:"DELETE_MUSIC_TRACK",payload:t}));var t},className:"p-2 rounded-lg transition-colors "+("dark"===c?"text-red-400 hover:bg-gray-700":"text-red-600 hover:bg-red-50"),children:u.jsx(je,{size:16})})]})]})},e.id)),0===m.length&&u.jsxs("div",{className:"text-center py-12 "+("dark"===c?"text-gray-400":"text-gray-600"),children:[u.jsx(le,{size:48,className:"mx-auto mb-4 opacity-50"}),u.jsx("p",{children:"还没有上传音乐，点击上方按钮上传第一首音乐吧！"})]})]})]}),"settings"===k&&u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("h3",{className:"text-2xl font-bold",children:"网站设置"}),u.jsxs("button",{onClick:()=>{const e=[];L.autoPlayOnPageLoad&&e.push("onPageLoad"),L.autoPlayOnArticleOpen&&e.push("onArticleOpen");const t={github:L.github.trim()||void 0,twitter:L.twitter.trim()||void 0,weibo:L.weibo.trim()||void 0,email:L.email.trim()||void 0,bilibili:L.bilibili.trim()||void 0,wechat:L.wechat.trim()||void 0,qq:L.qq.trim()||void 0};a({type:"UPDATE_SITE_SETTINGS",payload:{siteName:L.siteName.trim(),siteDescription:L.siteDescription.trim(),siteAuthor:L.siteAuthor.trim(),currentBackground:L.currentBackground,socialLinks:t,socialLinksEnabled:{github:Boolean(L.github.trim()),twitter:Boolean(L.twitter.trim()),weibo:Boolean(L.weibo.trim()),email:Boolean(L.email.trim()),bilibili:Boolean(L.bilibili.trim()),wechat:Boolean(L.wechat.trim()),qq:Boolean(L.qq.trim())},musicSettings:{isEnabled:L.musicEnabled,autoPlay:L.autoPlay,autoPlayConditions:e,playMode:L.playMode,volume:L.volume},requireLoginForComments:L.requireLoginForComments}}),alert("设置已保存！")},className:"flex items-center gap-2 px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors",children:[u.jsx(he,{size:18}),"保存设置"]})]}),u.jsxs("div",{className:"grid gap-6",children:[u.jsxs("div",{className:`p-6 rounded-lg ${"dark"===c?"bg-gray-800":"bg-white"} border ${"dark"===c?"border-gray-700":"border-gray-200"}`,children:[u.jsx("h4",{className:"text-lg font-semibold mb-4",children:"基本信息"}),u.jsxs("div",{className:"grid gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium mb-2",children:"网站名称"}),u.jsx("input",{type:"text",value:L.siteName,onChange:e=>R(t=>i(n({},t),{siteName:e.target.value})),className:`w-full px-4 py-2 rounded-lg border ${"dark"===c?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-800"} focus:outline-none focus:ring-2 focus:ring-blue-500`})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium mb-2",children:"网站描述"}),u.jsx("textarea",{value:L.siteDescription,onChange:e=>R(t=>i(n({},t),{siteDescription:e.target.value})),className:`w-full px-4 py-2 rounded-lg border ${"dark"===c?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-800"} focus:outline-none focus:ring-2 focus:ring-blue-500`,rows:3})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium mb-2",children:"站长名称"}),u.jsx("input",{type:"text",value:L.siteAuthor,onChange:e=>R(t=>i(n({},t),{siteAuthor:e.target.value})),className:`w-full px-4 py-2 rounded-lg border ${"dark"===c?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-800"} focus:outline-none focus:ring-2 focus:ring-blue-500`})]})]})]}),u.jsxs("div",{className:`p-6 rounded-lg ${"dark"===c?"bg-gray-800":"bg-white"} border ${"dark"===c?"border-gray-700":"border-gray-200"}`,children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsx("h4",{className:"text-lg font-semibold",children:"背景设置"}),u.jsxs("button",{onClick:()=>{var e;return null==(e=E.current)?void 0:e.click()},className:"flex items-center gap-2 px-3 py-1 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors text-sm",children:[u.jsx(J,{size:16}),"上传壁纸"]})]}),u.jsx("input",{ref:E,type:"file",accept:"image/*",onChange:e=>d(this,null,function*(){var t;const r=null==(t=e.target.files)?void 0:t[0];if(!r)return;const o=URL.createObjectURL(r),s={id:Date.now().toString(),name:r.name,url:o,uploadedAt:(new Date).toISOString()};a({type:"UPDATE_SITE_SETTINGS",payload:{customBackgrounds:[...l.customBackgrounds,s]}})}),className:"hidden"}),u.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[l.backgroundImages.map((e,t)=>u.jsxs("div",{onClick:()=>R(t=>i(n({},t),{currentBackground:e})),className:"relative aspect-video rounded-lg overflow-hidden cursor-pointer border-2 transition-all "+(L.currentBackground===e?"border-blue-500 ring-2 ring-blue-200":"border-gray-300 hover:border-gray-400"),children:[u.jsx("img",{src:e,alt:`背景 ${t+1}`,className:"w-full h-full object-cover"}),L.currentBackground===e&&u.jsx("div",{className:"absolute inset-0 bg-blue-500/20 flex items-center justify-center",children:u.jsx("div",{className:"w-6 h-6 rounded-full bg-blue-500 text-white flex items-center justify-center",children:"✓"})})]},t)),l.customBackgrounds.map(e=>u.jsxs("div",{onClick:()=>R(t=>i(n({},t),{currentBackground:e.url})),className:"relative aspect-video rounded-lg overflow-hidden cursor-pointer border-2 transition-all "+(L.currentBackground===e.url?"border-blue-500 ring-2 ring-blue-200":"border-gray-300 hover:border-gray-400"),children:[u.jsx("img",{src:e.url,alt:e.name,className:"w-full h-full object-cover"}),L.currentBackground===e.url&&u.jsx("div",{className:"absolute inset-0 bg-blue-500/20 flex items-center justify-center",children:u.jsx("div",{className:"w-6 h-6 rounded-full bg-blue-500 text-white flex items-center justify-center",children:"✓"})})]},e.id))]})]}),u.jsxs("div",{className:`p-6 rounded-lg ${"dark"===c?"bg-gray-800":"bg-white"} border ${"dark"===c?"border-gray-700":"border-gray-200"}`,children:[u.jsx("h4",{className:"text-lg font-semibold mb-4",children:"社交链接"}),u.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium mb-2",children:"GitHub"}),u.jsx("input",{type:"url",value:L.github,onChange:e=>R(t=>i(n({},t),{github:e.target.value})),className:`w-full px-4 py-2 rounded-lg border ${"dark"===c?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-800"} focus:outline-none focus:ring-2 focus:ring-blue-500`,placeholder:"https://github.com/username"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium mb-2",children:"Bilibili"}),u.jsx("input",{type:"url",value:L.bilibili,onChange:e=>R(t=>i(n({},t),{bilibili:e.target.value})),className:`w-full px-4 py-2 rounded-lg border ${"dark"===c?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-800"} focus:outline-none focus:ring-2 focus:ring-blue-500`,placeholder:"https://space.bilibili.com/userid"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium mb-2",children:"微信"}),u.jsx("input",{type:"text",value:L.wechat,onChange:e=>R(t=>i(n({},t),{wechat:e.target.value})),className:`w-full px-4 py-2 rounded-lg border ${"dark"===c?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-800"} focus:outline-none focus:ring-2 focus:ring-blue-500`,placeholder:"微信号"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium mb-2",children:"QQ"}),u.jsx("input",{type:"text",value:L.qq,onChange:e=>R(t=>i(n({},t),{qq:e.target.value})),className:`w-full px-4 py-2 rounded-lg border ${"dark"===c?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-800"} focus:outline-none focus:ring-2 focus:ring-blue-500`,placeholder:"QQ号"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium mb-2",children:"Twitter"}),u.jsx("input",{type:"url",value:L.twitter,onChange:e=>R(t=>i(n({},t),{twitter:e.target.value})),className:`w-full px-4 py-2 rounded-lg border ${"dark"===c?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-800"} focus:outline-none focus:ring-2 focus:ring-blue-500`,placeholder:"https://twitter.com/username"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium mb-2",children:"邮箱"}),u.jsx("input",{type:"email",value:L.email,onChange:e=>R(t=>i(n({},t),{email:e.target.value})),className:`w-full px-4 py-2 rounded-lg border ${"dark"===c?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-800"} focus:outline-none focus:ring-2 focus:ring-blue-500`,placeholder:"email@example.com"})]})]})]}),u.jsxs("div",{className:`p-6 rounded-lg ${"dark"===c?"bg-gray-800":"bg-white"} border ${"dark"===c?"border-gray-700":"border-gray-200"}`,children:[u.jsx("h4",{className:"text-lg font-semibold mb-4",children:"音乐播放设置"}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("span",{children:"启用音乐播放"}),u.jsx("button",{onClick:()=>R(e=>i(n({},e),{musicEnabled:!e.musicEnabled})),className:"relative inline-flex h-6 w-11 items-center rounded-full "+(L.musicEnabled?"bg-blue-500":"bg-gray-300"),children:u.jsx("span",{className:"inline-block h-4 w-4 transform rounded-full bg-white transition "+(L.musicEnabled?"translate-x-6":"translate-x-1")})})]}),L.musicEnabled&&u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("span",{children:"自动播放"}),u.jsx("button",{onClick:()=>R(e=>i(n({},e),{autoPlay:!e.autoPlay})),className:"relative inline-flex h-6 w-11 items-center rounded-full "+(L.autoPlay?"bg-blue-500":"bg-gray-300"),children:u.jsx("span",{className:"inline-block h-4 w-4 transform rounded-full bg-white transition "+(L.autoPlay?"translate-x-6":"translate-x-1")})})]}),L.autoPlay&&u.jsxs("div",{className:"space-y-3 pl-4 border-l-2 border-blue-200",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("input",{type:"checkbox",id:"autoPlayOnPageLoad",checked:L.autoPlayOnPageLoad,onChange:e=>R(t=>i(n({},t),{autoPlayOnPageLoad:e.target.checked})),className:"w-4 h-4 text-blue-600 rounded focus:ring-blue-500"}),u.jsx("label",{htmlFor:"autoPlayOnPageLoad",className:"text-sm",children:"打开网页时自动播放"})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("input",{type:"checkbox",id:"autoPlayOnArticleOpen",checked:L.autoPlayOnArticleOpen,onChange:e=>R(t=>i(n({},t),{autoPlayOnArticleOpen:e.target.checked})),className:"w-4 h-4 text-blue-600 rounded focus:ring-blue-500"}),u.jsx("label",{htmlFor:"autoPlayOnArticleOpen",className:"text-sm",children:"打开文章页面时自动播放"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium mb-2",children:"播放模式"}),u.jsxs("select",{value:L.playMode,onChange:e=>R(t=>i(n({},t),{playMode:e.target.value})),className:`w-full px-4 py-2 rounded-lg border ${"dark"===c?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-800"} focus:outline-none focus:ring-2 focus:ring-blue-500`,children:[u.jsx("option",{value:"sequence",children:"顺序播放"}),u.jsx("option",{value:"loop",children:"单曲循环"}),u.jsx("option",{value:"random",children:"随机播放"})]})]}),u.jsxs("div",{children:[u.jsxs("label",{className:"block text-sm font-medium mb-2",children:["默认音量 (",Math.round(100*L.volume),"%)"]}),u.jsx("input",{type:"range",min:"0",max:"1",step:"0.01",value:L.volume,onChange:e=>R(t=>i(n({},t),{volume:parseFloat(e.target.value)})),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"})]})]})]})]}),u.jsxs("div",{className:`p-6 rounded-lg ${"dark"===c?"bg-gray-800":"bg-white"} border ${"dark"===c?"border-gray-700":"border-gray-200"}`,children:[u.jsx("h4",{className:"text-lg font-semibold mb-4",children:"评论设置"}),u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("span",{children:"评论需要登录"}),u.jsx("button",{onClick:()=>R(e=>i(n({},e),{requireLoginForComments:!e.requireLoginForComments})),className:"relative inline-flex h-6 w-11 items-center rounded-full "+(L.requireLoginForComments?"bg-blue-500":"bg-gray-300"),children:u.jsx("span",{className:"inline-block h-4 w-4 transform rounded-full bg-white transition "+(L.requireLoginForComments?"translate-x-6":"translate-x-1")})})]})]})]})]}),"github"===k&&u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("h3",{className:"text-2xl font-bold",children:"数据同步"}),u.jsxs("div",{className:"flex items-center gap-2",children:[y&&u.jsxs("span",{className:"text-sm text-gray-500",children:["上次同步：",new Date(y).toLocaleString()]}),u.jsx("div",{className:"px-2 py-1 rounded-full text-xs "+("success"===C?"bg-green-100 text-green-800":"error"===C?"bg-red-100 text-red-800":"syncing"===C?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-600"),children:"success"===C?"同步成功":"error"===C?"同步失败":"syncing"===C?"同步中...":"等待同步"})]})]}),u.jsxs("div",{className:`p-6 rounded-lg ${"dark"===c?"bg-gray-800":"bg-white"} border ${"dark"===c?"border-gray-700":"border-gray-200"}`,children:[u.jsx("h4",{className:"text-lg font-semibold mb-4",children:"GitHub 配置"}),u.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium mb-2",children:"仓库所有者"}),u.jsx("input",{type:"text",value:P.owner,onChange:e=>$(t=>i(n({},t),{owner:e.target.value})),className:`w-full px-4 py-2 rounded-lg border ${"dark"===c?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-800"} focus:outline-none focus:ring-2 focus:ring-blue-500`,placeholder:"用户名或组织名"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium mb-2",children:"仓库名称"}),u.jsx("input",{type:"text",value:P.repo,onChange:e=>$(t=>i(n({},t),{repo:e.target.value})),className:`w-full px-4 py-2 rounded-lg border ${"dark"===c?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-800"} focus:outline-none focus:ring-2 focus:ring-blue-500`,placeholder:"仓库名称"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium mb-2",children:"分支名称"}),u.jsx("input",{type:"text",value:P.branch,onChange:e=>$(t=>i(n({},t),{branch:e.target.value})),className:`w-full px-4 py-2 rounded-lg border ${"dark"===c?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-800"} focus:outline-none focus:ring-2 focus:ring-blue-500`,placeholder:"main"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium mb-2",children:"访问令牌"}),u.jsx("input",{type:"password",value:P.token,onChange:e=>$(t=>i(n({},t),{token:e.target.value})),className:`w-full px-4 py-2 rounded-lg border ${"dark"===c?"bg-gray-700 border-gray-600 text-white":"bg-white border-gray-300 text-gray-800"} focus:outline-none focus:ring-2 focus:ring-blue-500`,placeholder:"GitHub Personal Access Token"})]})]}),u.jsxs("button",{onClick:()=>{if(!P.owner||!P.repo||!P.token)return void alert("请填写完整的GitHub配置信息");const e={owner:P.owner.trim(),repo:P.repo.trim(),token:P.token.trim(),branch:P.branch.trim()||"main"};a({type:"SET_GITHUB_CONFIG",payload:e}),function(e){Ye=new Ze(e)}(e),alert("GitHub配置已保存！")},className:"mt-4 flex items-center gap-2 px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors",children:[u.jsx(he,{size:18}),"保存配置"]})]}),u.jsxs("div",{className:`p-6 rounded-lg ${"dark"===c?"bg-gray-800":"bg-white"} border ${"dark"===c?"border-gray-700":"border-gray-200"}`,children:[u.jsx("h4",{className:"text-lg font-semibold mb-4",children:"同步操作"}),u.jsxs("div",{className:"flex gap-4",children:[u.jsxs("button",{onClick:()=>d(this,null,function*(){const e=Je();if(e){T("syncing");try{yield e.syncToGitHub({articles:o,comments:r.comments,users:s.filter(e=>"admin"===e.role),siteSettings:l,musicTracks:m,lastUpdated:(new Date).toISOString()}),a({type:"SET_LAST_SYNC_TIME",payload:(new Date).toISOString()}),T("success"),setTimeout(()=>T("idle"),3e3)}catch(t){console.error("同步失败:",t),T("error"),alert("同步失败，请检查GitHub配置和网络连接"),setTimeout(()=>T("idle"),3e3)}}else alert("请先配置GitHub设置")}),disabled:"syncing"===C||!b,className:`flex items-center gap-2 px-4 py-2 rounded-lg transition-colors ${"syncing"!==C&&b?"bg-green-500 hover:bg-green-600":"bg-gray-400 cursor-not-allowed"} text-white`,children:[u.jsx(G,{size:18}),"上传到 GitHub"]}),u.jsxs("button",{onClick:()=>d(this,null,function*(){const e=Je();if(e){T("syncing");try{const t=yield e.syncFromGitHub();t?(a({type:"LOAD_DATA",payload:t}),T("success"),alert("数据同步成功！")):alert("未找到远程数据"),setTimeout(()=>T("idle"),3e3)}catch(t){console.error("同步失败:",t),T("error"),alert("同步失败，请检查GitHub配置和网络连接"),setTimeout(()=>T("idle"),3e3)}}else alert("请先配置GitHub设置")}),disabled:"syncing"===C||!b,className:`flex items-center gap-2 px-4 py-2 rounded-lg transition-colors ${"syncing"!==C&&b?"bg-blue-500 hover:bg-blue-600":"bg-gray-400 cursor-not-allowed"} text-white`,children:[u.jsx(B,{size:18}),"从 GitHub 下载"]})]}),u.jsxs("div",{className:"mt-4 p-4 rounded-lg "+("dark"===c?"bg-gray-700":"bg-gray-50"),children:[u.jsx("h5",{className:"font-medium mb-2",children:"说明："}),u.jsxs("ul",{className:"text-sm space-y-1 text-gray-600",children:[u.jsx("li",{children:"• 上传到 GitHub：将当前博客数据同步到 GitHub 仓库"}),u.jsx("li",{children:"• 从 GitHub 下载：从 GitHub 仓库恢复博客数据"}),u.jsx("li",{children:"• 需要先配置 GitHub 个人访问令牌，确保有仓库写入权限"}),u.jsx("li",{children:"• 建议定期备份数据到 GitHub，防止数据丢失"})]})]})]})]})]})]})})}function Xe({className:e=""}){const{state:t,dispatch:r}=O(),{musicTracks:a,currentTrack:o,isPlaying:s,siteSettings:{musicSettings:l},currentTheme:c}=t,d=h.useRef(null),[g,m]=h.useState(0),[p,x]=h.useState(0),[b,y]=h.useState(l.volume),[k,f]=h.useState(!1),[v,w]=h.useState(!1),[j,N]=h.useState(l.playMode);h.useEffect(()=>{const e=d.current;if(!e)return;const t=()=>m(e.currentTime),r=()=>x(e.duration),a=()=>C();return e.addEventListener("timeupdate",t),e.addEventListener("loadedmetadata",r),e.addEventListener("ended",a),()=>{e.removeEventListener("timeupdate",t),e.removeEventListener("loadedmetadata",r),e.removeEventListener("ended",a)}},[o]),h.useEffect(()=>{const e=d.current;e&&(e.volume=b,r({type:"UPDATE_SITE_SETTINGS",payload:{musicSettings:i(n({},l),{volume:b})}}))},[b]),h.useEffect(()=>{const e=d.current;e&&o&&(s?e.play().catch(console.error):e.pause())},[s,o]);const S=e=>{if(isNaN(e))return"0:00";return`${Math.floor(e/60)}:${Math.floor(e%60).toString().padStart(2,"0")}`},C=()=>{if(0===a.length)return;const e=a.findIndex(e=>e.id===(null==o?void 0:o.id));let t;switch(j){case"random":t=Math.floor(Math.random()*a.length);break;case"loop":t=e;break;default:t=(e+1)%a.length}r({type:"SET_CURRENT_TRACK",payload:a[t]}),r({type:"SET_PLAYING",payload:!0})};if(!l.isEnabled||0===a.length)return null;const T=()=>{switch(j){case"loop":return u.jsx(ge,{size:16});case"random":return u.jsx(be,{size:16});default:return u.jsx(ue,{size:16})}};return u.jsxs(u.Fragment,{children:[o&&u.jsx("audio",{ref:d,src:o.url,preload:"metadata"}),u.jsx("div",{className:`fixed bottom-4 right-4 z-40 ${e}`,children:u.jsxs("div",{className:`rounded-lg shadow-lg backdrop-blur-sm transition-all duration-300 ${"dark"===c?"bg-gray-800/90 border border-gray-700":"bg-white/90 border border-gray-200"} ${v?"w-80":"w-16"}`,children:[!v&&u.jsx("div",{className:"p-4",children:u.jsx("button",{onClick:()=>w(!0),className:"p-2 rounded-full transition-colors "+("dark"===c?"text-gray-300 hover:text-white hover:bg-gray-700":"text-gray-600 hover:text-gray-800 hover:bg-gray-100"),children:u.jsx(le,{size:20})})}),v&&u.jsxs("div",{className:"p-4 space-y-3",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(le,{size:18,className:"dark"===c?"text-gray-300":"text-gray-600"}),u.jsx("span",{className:"text-sm font-medium "+("dark"===c?"text-gray-200":"text-gray-800"),children:"音乐播放器"})]}),u.jsx("button",{onClick:()=>w(!1),className:"p-1 rounded transition-colors "+("dark"===c?"text-gray-400 hover:text-white":"text-gray-500 hover:text-gray-700"),children:u.jsx(q,{size:16})})]}),o&&u.jsxs("div",{className:"text-center",children:[u.jsx("h3",{className:"text-sm font-medium truncate "+("dark"===c?"text-gray-200":"text-gray-800"),children:o.title}),u.jsx("p",{className:"text-xs truncate "+("dark"===c?"text-gray-400":"text-gray-600"),children:o.artist})]}),o&&u.jsxs("div",{className:"space-y-1",children:[u.jsx("div",{className:"h-2 rounded-full cursor-pointer "+("dark"===c?"bg-gray-700":"bg-gray-200"),onClick:e=>{const t=d.current;if(!t)return;const r=e.currentTarget.getBoundingClientRect(),a=(e.clientX-r.left)/r.width*p;t.currentTime=a,m(a)},children:u.jsx("div",{className:"h-full bg-blue-500 rounded-full transition-all",style:{width:g/p*100+"%"}})}),u.jsxs("div",{className:"flex justify-between text-xs "+("dark"===c?"text-gray-400":"text-gray-600"),children:[u.jsx("span",{children:S(g)}),u.jsx("span",{children:S(p)})]})]}),u.jsxs("div",{className:"flex items-center justify-center gap-3",children:[u.jsx("button",{onClick:()=>{const e=["sequence","loop","random"],t=e.indexOf(j),a=e[(t+1)%e.length];N(a),r({type:"UPDATE_SITE_SETTINGS",payload:{musicSettings:i(n({},l),{playMode:a})}})},className:"p-2 rounded-full transition-colors "+("dark"===c?"text-gray-400 hover:text-white hover:bg-gray-700":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"),title:"播放模式: "+("sequence"===j?"顺序":"loop"===j?"单曲循环":"随机"),children:u.jsx(T,{})}),u.jsx("button",{onClick:()=>{if(0===a.length)return;const e=a.findIndex(e=>e.id===(null==o?void 0:o.id));let t;switch(j){case"random":t=Math.floor(Math.random()*a.length);break;case"loop":t=e;break;default:t=(e-1+a.length)%a.length}r({type:"SET_CURRENT_TRACK",payload:a[t]}),r({type:"SET_PLAYING",payload:!0})},disabled:0===a.length,className:"p-2 rounded-full transition-colors "+(0===a.length?"text-gray-400 cursor-not-allowed":"dark"===c?"text-gray-300 hover:text-white hover:bg-gray-700":"text-gray-600 hover:text-gray-800 hover:bg-gray-100"),children:u.jsx(ye,{size:20})}),u.jsx("button",{onClick:()=>{!o&&a.length>0?(r({type:"SET_CURRENT_TRACK",payload:a[0]}),r({type:"SET_PLAYING",payload:!0})):r({type:"SET_PLAYING",payload:!s})},disabled:0===a.length,className:`p-3 rounded-full transition-all ${0===a.length?"bg-gray-400 cursor-not-allowed":"bg-blue-500 hover:bg-blue-600 transform hover:scale-105"} text-white`,children:s?u.jsx(ne,{size:20}):u.jsx(ie,{size:20})}),u.jsx("button",{onClick:C,disabled:0===a.length,className:"p-2 rounded-full transition-colors "+(0===a.length?"text-gray-400 cursor-not-allowed":"dark"===c?"text-gray-300 hover:text-white hover:bg-gray-700":"text-gray-600 hover:text-gray-800 hover:bg-gray-100"),children:u.jsx(ke,{size:20})}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("button",{onClick:()=>{k?(y(l.volume||.7),f(!1)):(y(0),f(!0))},className:"p-1 rounded transition-colors "+("dark"===c?"text-gray-400 hover:text-white":"text-gray-500 hover:text-gray-700"),children:k||0===b?u.jsx(Le,{size:16}):u.jsx(Ae,{size:16})}),u.jsx("input",{type:"range",min:"0",max:"1",step:"0.01",value:b,onChange:e=>{const t=parseFloat(e.target.value);y(t),f(0===t)},className:"w-16 h-1 bg-gray-300 rounded-lg appearance-none cursor-pointer"})]})]})]})]})})]})}function et(){const{state:e,dispatch:t}=O(),{currentTheme:r,siteSettings:a,isAuthenticated:o,isAdminMode:s,currentUser:l,musicTracks:n,currentTrack:i,isPlaying:c}=e,[d,g]=h.useState(null),[m,p]=h.useState(!1),[x,b]=h.useState(!1),[y,k]=h.useState(!1),[f,v]=h.useState(!1),[w,j]=h.useState(!1);h.useEffect(()=>{const{musicSettings:e}=a;e.isEnabled&&e.autoPlay&&n.length>0&&e.autoPlayConditions.includes("onPageLoad")&&!i&&(t({type:"SET_CURRENT_TRACK",payload:n[0]}),t({type:"SET_PLAYING",payload:!0}))},[n,a.musicSettings]);return u.jsxs("div",{className:"min-h-screen transition-all duration-500 "+("dark"===r?"dark":""),style:{backgroundImage:`url(${a.currentBackground})`,backgroundSize:"cover",backgroundPosition:"center",backgroundAttachment:"fixed",backgroundRepeat:"no-repeat"},children:[u.jsx("div",{className:"fixed inset-0 transition-colors duration-500 "+("dark"===r?"bg-black/60":"bg-white/70"),style:{zIndex:-1}}),s&&u.jsx("div",{className:`fixed top-0 left-0 right-0 z-30 px-4 py-2 ${"dark"===r?"bg-blue-900/90":"bg-blue-500/90"} backdrop-blur-sm`,children:u.jsxs("div",{className:"flex items-center justify-between max-w-7xl mx-auto",children:[u.jsxs("div",{className:"flex items-center gap-2 text-white",children:[u.jsx(pe,{size:16}),u.jsx("span",{className:"text-sm font-medium",children:"当前处于站长模式"})]}),u.jsxs("button",{onClick:()=>k(!0),className:"flex items-center gap-2 px-3 py-1 rounded-md bg-white/20 hover:bg-white/30 text-white text-sm transition-colors",children:[u.jsx(pe,{size:14}),"打开设置"]})]})}),u.jsx("div",{className:"fixed top-4 right-4 z-30 flex items-center gap-2 "+(s?"mt-12":""),children:o?u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("div",{className:"px-3 py-2 rounded-lg backdrop-blur-sm "+("dark"===r?"bg-gray-800/90 text-gray-200":"bg-white/90 text-gray-800"),children:u.jsxs("span",{className:"text-sm",children:["欢迎，",null==l?void 0:l.displayName]})}),u.jsx("button",{onClick:()=>{t({type:"LOGOUT"})},className:"px-3 py-2 rounded-lg backdrop-blur-sm transition-all hover:scale-105 "+("dark"===r?"bg-red-600/90 hover:bg-red-500/90 text-white":"bg-red-500/90 hover:bg-red-600/90 text-white"),children:"登出"})]}):u.jsxs("button",{onClick:()=>{p(!0)},className:"flex items-center gap-2 px-4 py-2 rounded-lg backdrop-blur-sm transition-all hover:scale-105 "+("dark"===r?"bg-blue-600/90 hover:bg-blue-500/90 text-white":"bg-blue-500/90 hover:bg-blue-600/90 text-white"),children:[u.jsx(ee,{size:16}),u.jsx("span",{className:"text-sm font-medium",children:"登录/注册"})]})}),u.jsxs("div",{className:`relative z-10 transition-all duration-300 ${f?"opacity-0 scale-95":"opacity-100 scale-100"} ${s?"pt-12":""}`,children:[u.jsx(Oe,{}),u.jsx("main",{className:"transition-all duration-300 "+(w?"opacity-0 translate-y-4":"opacity-100 translate-y-0"),children:d?u.jsx(Be,{article:d,onBack:()=>{j(!0),setTimeout(()=>{g(null),j(!1)},150)},onOpenLogin:()=>p(!0)}):u.jsx(Pe,{onSelectArticle:e=>{j(!0),setTimeout(()=>{g(e),j(!1);const{musicSettings:r}=a;r.isEnabled&&r.autoPlay&&n.length>0&&r.autoPlayConditions.includes("onArticleOpen")&&!c&&(i||t({type:"SET_CURRENT_TRACK",payload:n[0]}),t({type:"SET_PLAYING",payload:!0}))},150)}})}),u.jsx(Ve,{onOpenAdmin:()=>{s?k(!0):b(!0)}})]}),u.jsx(Xe,{}),u.jsx(We,{isOpen:m,onClose:()=>p(!1),mode:"user"}),u.jsx(We,{isOpen:x,onClose:()=>{b(!1),s&&k(!0)},mode:"admin"}),u.jsx(Qe,{isOpen:y,onClose:()=>k(!1)})]})}function tt(){return u.jsx(R,{children:u.jsx(et,{})})}T.createRoot(document.getElementById("root")).render(u.jsx(h.StrictMode,{children:u.jsx(z,{children:u.jsx(tt,{})})}));
